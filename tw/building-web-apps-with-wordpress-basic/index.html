<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/tw/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/tw/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/tw/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/tw/images/logo.svg" color="#222">
  <meta http-equiv="Cache-Control" content="no-transform">
  <meta http-equiv="Cache-Control" content="no-siteapp">

<link rel="stylesheet" href="/tw/css/main.css">


<link rel="stylesheet" href="/tw/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"oberonlai.blog","root":"/tw/","scheme":"Mist","version":"7.8.0","exturl":false,"sidebar":{"position":"right","display":"post","padding":18,"offset":12,"onmobile":true},"copycode":{"enable":true,"show_result":true,"style":"mac"},"back2top":{"enable":true,"sidebar":false,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":true,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":"disqus","storage":true,"lazyload":false,"nav":{"disqus":{"text":"Load Disqus","order":-1}},"activeClass":"disqus"},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":false,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideDownIn","sidebar":"slideDownIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="二、WordPress Basic &#x2F; WordPress 基本介紹第二章的部分先從介紹 WordPress 主程式的資料夾結構以及資料庫結構與相對應的 API 開始。 WordPress 資料夾結構要開發 WordPress 之前，必須知道的第一條鐵律就是「永遠不要修改 WordPress」。這意思是說千萬不要去修改 WordPress 的核心程式，因為只要一更新所有的修改就會被覆蓋，而更新通常">
<meta property="og:type" content="article">
<meta property="og:title" content="【 書摘 】Building Web Apps with WordPress - WordPress 基本介紹">
<meta property="og:url" content="https://oberonlai.blog/tw/building-web-apps-with-wordpress-basic/">
<meta property="og:site_name" content="WordPress 開發日常">
<meta property="og:description" content="二、WordPress Basic &#x2F; WordPress 基本介紹第二章的部分先從介紹 WordPress 主程式的資料夾結構以及資料庫結構與相對應的 API 開始。 WordPress 資料夾結構要開發 WordPress 之前，必須知道的第一條鐵律就是「永遠不要修改 WordPress」。這意思是說千萬不要去修改 WordPress 的核心程式，因為只要一更新所有的修改就會被覆蓋，而更新通常">
<meta property="og:locale" content="zh_TW">
<meta property="og:image" content="https://oberonlai.blog/wp-content/uploads/2020/03/CleanShot-2020-03-25-at-08.54.29-1024x140.jpg">
<meta property="og:image" content="https://oberonlai.blog/wp-content/uploads/2020/03/CleanShot-2020-03-25-at-09.54.54-1024x249.jpg">
<meta property="og:image" content="https://oberonlai.blog/wp-content/uploads/2020/03/CleanShot-2020-03-26-at-09.17.43-1024x126.jpg">
<meta property="og:image" content="https://oberonlai.blog/wp-content/uploads/2020/03/CleanShot-2020-03-26-at-09.53.21-1024x515.jpg">
<meta property="og:image" content="https://oberonlai.blog/wp-content/uploads/2020/03/CleanShot-2020-03-27-at-09.51.32-1024x126.jpg">
<meta property="og:image" content="https://oberonlai.blog/wp-content/uploads/2020/03/CleanShot-2020-03-30-at-10.05.06-1024x349.jpg">
<meta property="og:image" content="https://oberonlai.blog/wp-content/uploads/2020/03/CleanShot-2020-03-31-at-10.15.35-1024x124.jpg">
<meta property="og:image" content="https://oberonlai.blog/wp-content/uploads/2020/03/CleanShot-2020-03-31-at-10.53.05.jpg">
<meta property="og:image" content="https://oberonlai.blog/wp-content/uploads/2020/03/CleanShot-2020-03-31-at-10.56.14-1024x123.jpg">
<meta property="og:image" content="https://oberonlai.blog/wp-content/uploads/2020/04/CleanShot-2020-04-01-at-10.04.09-1024x117.jpg">
<meta property="og:image" content="https://oberonlai.blog/wp-content/uploads/2020/04/CleanShot-2020-04-02-at-09.21.44-1024x165.jpg">
<meta property="og:image" content="https://oberonlai.blog/wp-content/uploads/2020/04/CleanShot-2020-04-02-at-09.50.41.jpg">
<meta property="article:published_time" content="2020-05-07T02:03:25.000Z">
<meta property="article:modified_time" content="2021-05-01T13:06:02.203Z">
<meta property="article:author" content="賴俊吾 &#x2F; Oberon Lai">
<meta property="article:tag" content="Hook">
<meta property="article:tag" content="localhost">
<meta property="article:tag" content="schema">
<meta property="article:tag" content="taxonomy">
<meta property="article:tag" content="wp_comment">
<meta property="article:tag" content="wp_option">
<meta property="article:tag" content="wp_posts">
<meta property="article:tag" content="wp_terms">
<meta property="article:tag" content="wp_users">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://oberonlai.blog/wp-content/uploads/2020/03/CleanShot-2020-03-25-at-08.54.29-1024x140.jpg">

<link rel="canonical" href="https://oberonlai.blog/tw/building-web-apps-with-wordpress-basic/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-TW'
  };
</script>

  <title>【 書摘 】Building Web Apps with WordPress - WordPress 基本介紹 | WordPress 開發日常</title>
  
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-163107142-1"></script>
    <script data-pjax>
      if (CONFIG.hostname === location.hostname) {
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'UA-163107142-1');
      }
    </script>






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切換導航欄">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta custom-logo">

    <a href="/tw/" class="brand" rel="start" style="display: block">
        <img class="logo-img" src="/tw/images/logo-w.svg" alt="WordPress 開發日常">
    </a>
      <p class="site-subtitle" itemprop="description">有任何 WordPress 客製需求歡迎與我聯絡！</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-關於我">

    <a href="/tw/about/" rel="section">關於我</a>

  </li>
        <li class="menu-item menu-item-合作方式">

    <a href="/tw/how-can-oberon-help-you/" rel="section">合作方式</a>

  </li>
        <li class="menu-item menu-item-計價方式">

    <a href="/tw/how-do-i-make-a-quotation/" rel="section">計價方式</a>

  </li>
        <li class="menu-item menu-item-學習-wordpress">

    <a href="/tw/wordpress-full-stack/" rel="section">學習 WordPress</a>

  </li>
        <li class="menu-item menu-item-與我聯繫">

    <a href="mailto:m615926@gmail.com" rel="noopener" target="_blank">與我聯繫</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger">搜尋
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜尋..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>

  <a href="https://github.com/oberonlai" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-TW">
    <link itemprop="mainEntityOfPage" href="https://oberonlai.blog/tw/building-web-apps-with-wordpress-basic/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/tw/images/avatar.jpg">
      <meta itemprop="name" content="賴俊吾 / Oberon Lai">
      <meta itemprop="description" content="現為全職 WordPress 工程師，網站開發經歷 11 年，專攻前端工程與 WordPress 佈景主題、外掛客製化開發">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="WordPress 開發日常">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          【 書摘 】Building Web Apps with WordPress - WordPress 基本介紹
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">發表於</span>

              <time title="創建時間：2020-05-07 10:03:25" itemprop="dateCreated datePublished" datetime="2020-05-07T10:03:25+08:00">2020-05-07</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新於</span>
                <time title="修改時間：2021-05-01 21:06:02" itemprop="dateModified" datetime="2021-05-01T21:06:02+08:00">2021-05-01</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分類於</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/tw/categories/WordPress/" itemprop="url" rel="index"><span itemprop="name">WordPress</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
    
    <a title="disqus" href="/tw/building-web-apps-with-wordpress-basic/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="building-web-apps-with-wordpress-basic/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
            <span class="post-meta-item" title="文章字數">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
              <span>25k</span>
            </span>
            <span class="post-meta-item" title="所需閱讀時間">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
              <span>23 分鐘</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h2 id="二、WordPress-Basic-WordPress-基本介紹"><a href="#二、WordPress-Basic-WordPress-基本介紹" class="headerlink" title="二、WordPress Basic / WordPress 基本介紹"></a>二、WordPress Basic / WordPress 基本介紹</h2><p>第二章的部分先從介紹 WordPress 主程式的資料夾結構以及資料庫結構與相對應的 API 開始。</p>
<h2 id="WordPress-資料夾結構"><a href="#WordPress-資料夾結構" class="headerlink" title="WordPress 資料夾結構"></a><strong>WordPress 資料夾結構</strong></h2><p>要開發 WordPress 之前，必須知道的第一條鐵律就是「永遠不要修改 WordPress」。這意思是說千萬不要去修改 WordPress 的核心程式，因為只要一更新所有的修改就會被覆蓋，而更新通常都會有修補漏洞的項目，所以為了要能讓網站維持在安全的狀態，更新到最新版本是必要的。</p>
<p>也因此不要修改核心程式碼，要修改之前先找看看有沒有相關的 Hook 可以使用，如果沒找到適合的可以回報給核心維護團隊，請他們把你需要的 Hook 加入，這樣最好的作法。</p>
<p>至於哪些是核心程式碼？除了 wp-content 資料夾以及 wp-config.php 以外，其他都是核心程式碼，你永遠、絕對、不要修改它！</p>
<span id="more"></span>

<blockquote>
<p>Hook 的機制可以想像成是蓋房子的時候預留的管線，當今天房客要牽新的電話線或是水管時，不用把牆壁全部打掉，只要用之前準備好的管線來接就可以。</p>
<p>Hook 分為兩種，Action 是可以把一些特定的 Function 交由 Hook 來執行，Filter 是可以修改參數、顯示文字與設定值，Hook 可以放在你的佈景主題或是外掛來執行，這樣就不用修改到核心程式碼。</p>
<p>現在還不了解 Hook 是什麼也沒關係，更多關於 Hook 的部分之後會一直反覆出現，反覆到你都嫌煩了它還是會一直出現XD，因為他是 WordPress 程式運作的核心要素之一。</p>
</blockquote>
<p>（ㄧ）wp-admin - 所有 WordPress 後台的程式碼都放在這個資料夾裡面，每個檔案都對應一個後台的頁面或是功能。</p>
<blockquote>
<p>如果想要客製 WordPress 後台，會需要知道一堆 Hook，有時候與其去爬 Google 查文件，個人覺得直接看檔案還比較快，有看到 do_action 就是可以掛 Action 的地方，有看到 apply_filter 就是可以掛 Filter 的地方，等找到 Hook 名稱再去 Google 看要怎麼用，不然官方列出來的 Hook 爆炸多，而且很多又長得超像，常常都是要不停用除錯法才能試到我想要的 Hook，非常花時間…</p>
</blockquote>
<p>（二）wp-include - WordPress 所有的 API 、類別都是放在這個資料夾裡面，深入理解他們可以了解 WordPress 的工作方式。</p>
<blockquote>
<p>裡面非常精彩，我最喜歡看他們的類別是怎麼設計的，或是常用的 function 是怎麼寫的，每次隨便逛逛都會有意想不到的收穫～</p>
</blockquote>
<p>（三）wp-content - 我們可以修改的地方，也是放外掛、佈景主題與上傳檔案的地方。</p>
<p>（四）wp-content/themes - 放所有佈景主題的資料夾，要手動上傳佈景主題把東西放在這邊就對了。</p>
<p>（五）wp-content/plugins - 放所有外掛的資料夾，要手動上傳外掛把東西放在這邊就對了。</p>
<p>（六）wp-content/mu-plugins - MU 是 Must Use 必須使用的意思，當把外掛放在這邊的時候，WordPress 會直接自動啟用該外掛，並且不會出現在後台 &gt; 外掛的清單之中，所以當今天如果你要停用所有外掛來進行網站除錯的時候，記得檢查一下有沒有 mu-plugins 這個資料夾，否則萬一問題是出在 mu-pluings 裡面的外掛時，會讓你以為自己在鬼打牆。</p>
<blockquote>
<p>專門定義資料結構的外掛，也就是註冊 CPT、Taxonomy、Nav 的外掛，非常適合放在這個資料夾，因為這些資料是網站的基本元素，不會因為換了佈景主題而消失，也不應該被停用，所以有預設應該被啟用的外掛就放在這邊。</p>
<p>如果要把外掛放在這個資料夾必須要有一隻主要的檔案 .php，然後要引入的檔案可以放在資料夾裡面，而主要檔案不可以放在資料夾裡面，不然會抓不到。</p>
</blockquote>
<p>wp-content 裡面還有其他資料夾，有 WordPress 內建的，也有會因為你使用的外掛而自動產生的，當要搬移網站的時候，最簡單的方式就是把整個 wp-content 打包然後丟到新家去，就能移轉你的網站。當然，資料庫也要記得搬，接下來說明資料庫結構：</p>
<h2 id="WordPress-資料庫結構"><a href="#WordPress-資料庫結構" class="headerlink" title="WordPress 資料庫結構"></a><strong>WordPress 資料庫結構</strong></h2><p>這邊介紹了 WordPress 的資料表，以及存取寫入這些資料表相關的 Function，這些 Function 都可以寫在佈景主題裡面的 function.php 來使用它，或是放在你自己寫的外掛裡面。</p>
<p>資料表名稱的前綴使用預設的 wp_，這可以在 wp-config.php 裡面透過以下參數來修改：</p>
<p>$table_prefix = ‘wp_’; // 把 wp 換成其他前綴</p>
<p>如果你的 WordPress 是使用主機面板安裝的，像是 cPanel、Plesk，因為安全性考量他們會自動幫你修改資料表前綴，所以你打開 PhpMyAdmin 要找的是 abc_options、abc_posts 這些資料表就好，前綴 abc 不用管他。</p>
<hr>
<p><strong>（ㄧ）wp_option</strong> - 該表存放全站設定相關的資料，也就是在後台左側選單 &gt; 設定裡面的設定都會存在這張表裡面，如果你有自己開發外掛的話，也可以把相關的變數存在這個表中。為了節省效能，在寫入時會先把設定的值組成一個陣列再進行 INSERT。</p>
<p><img src="https://oberonlai.blog/wp-content/uploads/2020/03/CleanShot-2020-03-25-at-08.54.29-1024x140.jpg"></p>
<p>wp_options 資料表結構</p>
<p>wp_options 相關的 Function 定義在 wp-include/option.php，常用的如下：</p>
<p><strong>add_option( $option_name, $option_value, autoload=yes) 新增設定</strong></p>
<p>它會先自動檢查 $option_name 是否存在，不存在的話新增一筆資料，已存在的話會把 $option_value 進行覆寫。autoload 預設為 yes，作用是設定該 $option 是否加入到快取之中。如果你確定每個頁面都會用到這個設定的話，就保持預設值 yes，反之為 no。範例如下：</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token comment">// add option</span>
<span class="token variable">$twitters</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span> <span class="token string single-quoted-string">'@bwawwp'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'@bmess'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'@jason_coleman'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 用陣列來整理 option_value</span>
<span class="token function">add_option</span><span class="token punctuation">(</span> <span class="token string single-quoted-string">'bwawwp_twitter_accounts'</span><span class="token punctuation">,</span> <span class="token variable">$twitters</span> <span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p><strong>update_option( $option_name, $option_value ) 更新設定</strong></p>
<p>更新已存在的 $optioni_value，如果該 $option_name 不存在的會自動新增一筆，範例如下：</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token comment">// update option</span>
<span class="token variable">$twitters</span> <span class="token operator">=</span> <span class="token function">array_merge</span><span class="token punctuation">(</span>
         <span class="token variable">$twitters</span><span class="token punctuation">,</span>
         <span class="token keyword">array</span><span class="token punctuation">(</span>
                 <span class="token string single-quoted-string">'@alphaweb'</span><span class="token punctuation">,</span>
                 <span class="token string single-quoted-string">'@pmproplugin'</span>
         <span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">update_option</span><span class="token punctuation">(</span> <span class="token string single-quoted-string">'bwawwp_twitter_accounts'</span><span class="token punctuation">,</span> <span class="token variable">$twitters</span> <span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><strong>get_option( $option_name ) 取得設定欄位的值</strong></p>
<p>範例如下：</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token comment">// get option</span>
<span class="token variable">$bwawwp_twitter_accounts</span> <span class="token operator">=</span> <span class="token function">get_option</span><span class="token punctuation">(</span> <span class="token string single-quoted-string">'bwawwp_twitter_accounts'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">foreach</span><span class="token punctuation">(</span> <span class="token variable">$bwawwp_twitter_accounts</span> <span class="token keyword">as</span> <span class="token variable">$account</span> <span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
<span class="token keyword">echo</span> <span class="token variable">$account</span><span class="token operator">.</span><span class="token string single-quoted-string">', '</span><span class="token punctuation">;</span> <span class="token comment">// 輸出 @bwawwp, @bmewss, @jason_coleman</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><strong>delete_option( $option_name ) 刪除設定欄位</strong></p>
<p>範例如下：</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token comment">// delete option</span>
<span class="token function">delete_option</span><span class="token punctuation">(</span> <span class="token string single-quoted-string">'bwawwp_twitter_accounts'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<blockquote>
<p>每次要修改網站管理員電子郵件的時候，WordPress 會發確認信到新的信箱來做確認，但我懶，所以都直接進 wp_options 這個表來修改管理員的 E-mail，找到 option_name 為 admin_email 的欄位，然後修改 option_value 為新的電子郵件即可。</p>
</blockquote>
<hr>
<p><strong>（二）wp_users</strong> - 存放使用者帳密與基本資料，如果要從資料庫修改使用者相關資訊，像是客戶忘記密碼或是要新增一個管理員帳號，就可以在這個表進行處理。</p>
<p><img src="https://oberonlai.blog/wp-content/uploads/2020/03/CleanShot-2020-03-25-at-09.54.54-1024x249.jpg"></p>
<p>wp_users 資料表結構</p>
<p>wp_users 相關的 Function 定義在 wp-include/pluggable.php、wp-include/user.php，常用的如下：</p>
<p><strong>wp_insert_user( $userdata ) 新增使用者</strong></p>
<p>$userdata 為一個陣列，使用陣列來定義使用者的資料欄位，範例如下：</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token comment">// insert user</span>
<span class="token variable">$userdata</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span>
    <span class="token string single-quoted-string">'user_login'</span>    <span class="token operator">=></span> <span class="token string single-quoted-string">'brian'</span><span class="token punctuation">,</span>
<span class="token string single-quoted-string">'user_pass'</span>     <span class="token operator">=></span> <span class="token string single-quoted-string">'KO03gT7@n*'</span><span class="token punctuation">,</span>
<span class="token string single-quoted-string">'user_nicename'</span> <span class="token operator">=></span> <span class="token string single-quoted-string">'Brian'</span><span class="token punctuation">,</span>
<span class="token string single-quoted-string">'user_url'</span>      <span class="token operator">=></span> <span class="token string single-quoted-string">'https://alphaweb.com/'</span><span class="token punctuation">,</span>
<span class="token string single-quoted-string">'user_email'</span>    <span class="token operator">=></span> <span class="token string single-quoted-string">'brian@alphaweb.com'</span><span class="token punctuation">,</span>
<span class="token string single-quoted-string">'display_name'</span>  <span class="token operator">=></span> <span class="token string single-quoted-string">'Brian'</span><span class="token punctuation">,</span>
<span class="token string single-quoted-string">'nickname'</span>      <span class="token operator">=></span> <span class="token string single-quoted-string">'Brian'</span><span class="token punctuation">,</span>
<span class="token string single-quoted-string">'first_name'</span>    <span class="token operator">=></span> <span class="token string single-quoted-string">'Brian'</span><span class="token punctuation">,</span>
<span class="token string single-quoted-string">'last_name'</span>     <span class="token operator">=></span> <span class="token string single-quoted-string">'Messenlehner'</span><span class="token punctuation">,</span>
<span class="token string single-quoted-string">'description'</span>   <span class="token operator">=></span> <span class="token string single-quoted-string">'This is a WordPress Administrator account.'</span><span class="token punctuation">,</span>
<span class="token string single-quoted-string">'role'</span>          <span class="token operator">=></span> <span class="token string single-quoted-string">'administrator'</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">wp_insert_user</span><span class="token punctuation">(</span> <span class="token variable">$userdata</span> <span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><strong>wp_create_user( $username, $password, $email ) 新增使用者簡易版</strong></p>
<p>相較於 wp_insert_user()，它只要提供帳戶名、密碼、電子郵件三個參數就可以新增使用者，範例如下：</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token comment">// create users</span>
<span class="token function">wp_create_user</span><span class="token punctuation">(</span> <span class="token string single-quoted-string">'jason'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'YR529G%*v@'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'jason@schoolpress.me'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token operator">**</span><span class="token function">wp_update_user</span><span class="token punctuation">(</span> <span class="token variable">$userdata</span> <span class="token punctuation">)</span> 修改 wp_users 與 wp_usermeta 裡面的欄位<span class="token operator">**</span>

如果修改了使用者密碼，所有的 cookie 會被清除，該使用者會強制登出，<span class="token variable">$userdata</span> 的欄位與 <span class="token function">wp_insert_user</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 相同，範例如下：

<span class="token comment">// update user-change username fields and change role to admin</span>
<span class="token variable">$userdata</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span>
<span class="token string single-quoted-string">'ID'</span>         <span class="token operator">=></span> <span class="token variable">$user</span><span class="token operator">-></span><span class="token constant">ID</span><span class="token punctuation">,</span>
    <span class="token string single-quoted-string">'user_pass'</span>  <span class="token operator">=></span> <span class="token string single-quoted-string">'KO03gT7@n*'</span><span class="token punctuation">,</span>
<span class="token string single-quoted-string">'first_name'</span> <span class="token operator">=></span> <span class="token string single-quoted-string">'Jason'</span><span class="token punctuation">,</span>
<span class="token string single-quoted-string">'last_name'</span>  <span class="token operator">=></span> <span class="token string single-quoted-string">'Coleman'</span><span class="token punctuation">,</span>
<span class="token string single-quoted-string">'user_url'</span>   <span class="token operator">=></span> <span class="token string single-quoted-string">'http://strangerstudios.com/'</span><span class="token punctuation">,</span>
<span class="token string single-quoted-string">'role'</span>       <span class="token operator">=></span> <span class="token string single-quoted-string">'administrator'</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">wp_update_user</span><span class="token punctuation">(</span> <span class="token variable">$userdata</span> <span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<blockquote>
<p>昨天用了這支來讓使用者在前台更新登入密碼，結果表單送出後一直噴「Cannot modify header information - headers already sent by…」這個惱人的錯誤，爬了<a target="_blank" rel="noopener" href="https://developer.wordpress.org/reference/functions/wp_update_user/">文件</a>才知道，登出再登入的動作需要清除與設定 Cookie，因此必須放在頁面的最前面來執行，也就是要比 get_header() 還要前面。</p>
<p>另外找到了這篇 —&gt; <a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/47297101/issue-when-updating-the-password-with-wp-update-user">https://stackoverflow.com/questions/47297101/issue-when-updating-the-password-with-wp-update-user</a></p>
<p>讓我理解到原來重設密碼後的登入是分三個動作：wp_set_password()、wp_set_auth_cookie()、wp_set_current_user()，只是 wp_update_user() 把這些動作都封裝起來可以直接使用。</p>
</blockquote>
<p><strong>get_user_by( $field, $value ) 根據使用者資料來取得使用者</strong></p>
<p>取得的使用者會以 WP_User 物件進行回傳，這支的作用等同於 Sql 語句下：SELECT * FROM wp_users WHERE $field = $value，$field 是使用者資料欄位，$value 是使用者資料值，範例如下：</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token comment">// get user by email</span>
<span class="token variable">$user</span> <span class="token operator">=</span> <span class="token function">get_user_by</span><span class="token punctuation">(</span> <span class="token string single-quoted-string">'email'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'jason@schoolpress.me'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token string single-quoted-string">'username: '</span> <span class="token operator">.</span> <span class="token variable">$user</span><span class="token operator">-></span><span class="token property">user_login</span> <span class="token operator">.</span> <span class="token string single-quoted-string">' / ID: '</span> <span class="token operator">.</span> <span class="token variable">$user</span><span class="token operator">-></span><span class="token constant">ID</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'&lt;br>'</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p><strong>wp_delete_user( $user_id, $reassign ) 刪除使用者並把該使用者文章移轉給其他人</strong></p>
<p>第一個參數為要被刪除的使用者 ID，第二個參數為要繼承文章的使用者 ID，要注意的是如果第二個參數沒有指定，則該使用者的文章都會被移除，範例如下：</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token comment">// delete user-delete the original admin and set their posts to our new admin</span>
<span class="token function">wp_delete_user</span><span class="token punctuation">(</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token variable">$user</span><span class="token operator">-></span><span class="token constant">ID</span> <span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<blockquote>
<p>忘記使用者密碼的話進入 wp_users 找到要修改密碼的使用者，然後找到 user_pass 欄位，在修改前記得先把你的新密碼用<a target="_blank" rel="noopener" href="https://www.md5hashgenerator.com/">這個工具</a>來加密成 MD5，加密後才把 MD5 的字串填進 user_pass。因為安全性考量，WordPress 會把所有的使用者密碼都用 MD5 進行加密，如果直接填未加密的密碼進去是無效的。</p>
<p>至於如何從資料庫新增一個管理員帳號可以參考這篇文章 —&gt; <a target="_blank" rel="noopener" href="https://wpengine.com/support/add-admin-user-phpmyadmin/">https://wpengine.com/support/add-admin-user-phpmyadmin/</a></p>
</blockquote>
<hr>
<p><strong>（三）wp_usermeta</strong> - 使用者自訂欄位</p>
<p>記錄使用者更多更詳細的資料，也就是除了 wp_user 已經寫死欄位以外的使用者資料，可自行新增使用者欄位</p>
<p><img src="https://oberonlai.blog/wp-content/uploads/2020/03/CleanShot-2020-03-26-at-09.17.43-1024x126.jpg"></p>
<p>wp_usermeta 資料表結構</p>
<p>wp_usermeta 相關 Function 常用的如下：</p>
<p><strong>get_user_meta( $user_id, $meta_key, $single=false ) 取得特定使用者的資料</strong></p>
<p>$user_id 為使用者 id，$meta_key 要取得的欄位，如果留空值，會回傳所有相同 $meta_key 的 $meta_value，$single 為 true 的話會以字串回傳符合第一個 $meta_key 的 $meta_value，false 的話則會使用陣列回傳所有符合的 $meta_value，範例如下：</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token comment">// get brian's id</span>
<span class="token variable">$brian_id</span> <span class="token operator">=</span> <span class="token function">get_user_by</span><span class="token punctuation">(</span> <span class="token string single-quoted-string">'login'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'brian'</span> <span class="token punctuation">)</span><span class="token operator">-></span><span class="token constant">ID</span><span class="token punctuation">;</span>
<span class="token variable">$brians_wife</span> <span class="token operator">=</span> <span class="token function">get_user_meta</span><span class="token punctuation">(</span> <span class="token variable">$brian_id</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'bwawwp_wife'</span><span class="token punctuation">,</span> <span class="token constant boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Wife 可能有多個(?)，true 的話回傳第一個</span>
<span class="token keyword">echo</span> <span class="token string double-quoted-string">"Brian's wife: "</span> <span class="token operator">.</span> <span class="token variable">$brians_wife</span> <span class="token operator">.</span> <span class="token string double-quoted-string">"&lt;br>"</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p><strong>update_user_meta( $user_id, $meta_key, $meta_value, $prev_value=”” ) 更新使用者的資料</strong></p>
<p>需要注意的是第四個參數，如果 $meta_key 有多筆符合，在 $prev_value 為空的情況下，$meta_value 只會修改第一筆 $meta_key，如果 $prev_value 有符合多筆 $meta_key 的 $meta_value 其中一筆，則這一筆的 value 會被第三個 $meta_value 給取代掉。範例如下：</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token comment">// update user meta - this will update brian to brian jr.</span>
<span class="token function">update_user_meta</span><span class="token punctuation">(</span> <span class="token variable">$brian_id</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'bwawwp_kid'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'Brian Jr'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'Briand'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Brian 有多個小孩(多筆相同的 meta_key)，名字叫做 Braind 的會被修改為 Brain Jr</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p><strong>add_user_meta( $user_id, $meta_key, $meta_value, $unique=false) 新增使用者資料欄位</strong></p>
<p>習慣上新增使用者資料會使用 update_user_meta()，因為它有判斷 $meta_key 是否存在的功能，會用 add_user_meta 的情境在於要新增多筆 $meat_value 到相同的 $meta_key。第四個參數 $unique 為 true 時代表不允許有多筆相同的 $meta_key，範例如下：</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token comment">// add user meta - 3rd parameter is a unique value</span>
<span class="token function">add_user_meta</span><span class="token punctuation">(</span> <span class="token variable">$brian_id</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'bwawwp_kid'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'Dalya'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">add_user_meta</span><span class="token punctuation">(</span> <span class="token variable">$brian_id</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'bwawwp_kid'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'Brian'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">add_user_meta</span><span class="token punctuation">(</span> <span class="token variable">$brian_id</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'bwawwp_kid'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'Nina'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">add_user_meta</span><span class="token punctuation">(</span> <span class="token variable">$brian_id</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'bwawwp_kid'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'Cam'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">add_user_meta</span><span class="token punctuation">(</span> <span class="token variable">$brian_id</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'bwawwp_kid'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'Aksel'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><strong>delete_user_meta( $user_id, $meta_key, $meta_value=””) 刪除使用者資料</strong></p>
<p>第三個參數當有指定 $meta_value 只會刪除符合該 value 的 $meta_key，範例如下：</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token comment">// delete brian's user meta</span>
<span class="token function">delete_user_meta</span><span class="token punctuation">(</span> <span class="token variable">$brian_id</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'bwawwp_wife'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">delete_user_meta</span><span class="token punctuation">(</span> <span class="token variable">$brian_id</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'bwawwp_kid'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'Dalya'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 沒指定 Dalya 的話則所有小孩都會被刪除</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<hr>
<p><strong>（四）wp_posts</strong> - 存放文章、頁面、選單、文章版本、以及自定義文章的資料表，而自定義文章就是用這個表裡面的 post_type 欄位來紀錄不同的文章類型</p>
<p><img src="https://oberonlai.blog/wp-content/uploads/2020/03/CleanShot-2020-03-26-at-09.53.21-1024x515.jpg"></p>
<p>wp_posts 資料表結構</p>
<p>wp_options 相關的 Function 定義在 wp-include/post.php，常用的如下：</p>
<p><strong>wp_inset_post( $postarr, $wp_error=false) 插入新文章</strong></p>
<p>$postarr 是一個定義新文章內容的陣列，裡面有許多參數可以定義，$wp_error 為 true 時會在文章插入失敗時回傳一個 WP_Error 物件，範例如下：</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token comment">// insert post - set post status to draft</span>
<span class="token variable">$args</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span>
<span class="token string single-quoted-string">'post_title'</span>   <span class="token operator">=></span> <span class="token string single-quoted-string">'文章標題'</span><span class="token punctuation">,</span>
<span class="token string single-quoted-string">'post_excerpt'</span> <span class="token operator">=></span> <span class="token string single-quoted-string">'文章摘要'</span><span class="token punctuation">,</span>
<span class="token string single-quoted-string">'post_content'</span> <span class="token operator">=></span> <span class="token string single-quoted-string">'內文'</span><span class="token punctuation">,</span>
<span class="token string single-quoted-string">'post_status'</span>  <span class="token operator">=></span> <span class="token string single-quoted-string">'draft'</span><span class="token punctuation">,</span>  <span class="token comment">// 文章狀態，有 draft、publish</span>
<span class="token string single-quoted-string">'post_type'</span>    <span class="token operator">=></span> <span class="token string single-quoted-string">'post'</span><span class="token punctuation">,</span> <span class="token comment">// 文章類型，預設為 post，可以是 page 或其他 CPT</span>
<span class="token string single-quoted-string">'post_author'</span>  <span class="token operator">=></span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token comment">// 作者 ID</span>
<span class="token string single-quoted-string">'menu_order'</span>   <span class="token operator">=></span> <span class="token number">0</span> <span class="token comment">// 文章順序</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$post_id</span> <span class="token operator">=</span> <span class="token function">wp_insert_post</span><span class="token punctuation">(</span> <span class="token variable">$args</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 新文章插入完成後會回傳該文章的 post ID</span>
<span class="token keyword">echo</span> <span class="token string single-quoted-string">'post ID: '</span> <span class="token operator">.</span> <span class="token variable">$post_id</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'&lt;br>'</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><strong>wp_update_post( $postarr, $wp_error = false) 更新文章資料</strong></p>
<p>同樣使用 $postarr 陣列來更新資料，記得要提供需要被更新的文章 ID，範例如下：</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token comment">// update post - change post status to publish</span>
<span class="token variable">$args</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span>
<span class="token string single-quoted-string">'ID'</span>  <span class="token operator">=></span> <span class="token variable">$post_id</span><span class="token punctuation">,</span>
<span class="token string single-quoted-string">'post_status'</span> <span class="token operator">=></span> <span class="token string single-quoted-string">'publish'</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">wp_update_post</span><span class="token punctuation">(</span> <span class="token variable">$args</span> <span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><strong>get_post( $post=null, $output=OBJECT, $filter=’raw’) 取得文章資料</strong></p>
<p>第一個參數指定要取得的文章的 ID，如果是在 post loop 中的話留空會自動取得當前文章。$output 資料格式可以設定為 OBJECT 或是 ARRAY_A (關聯式陣列) 與 ARRAY_N(索引式陣列)。$filter 參數為設定要 sanitize 的模式，可選值有 raw、edit、db、display、attribute 與 js，這是與安全性有關的議題，會在第八章的時候提到。範例如下：</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token comment">// get post - return post data as an object</span>
<span class="token variable">$post</span> <span class="token operator">=</span> <span class="token function">get_post</span><span class="token punctuation">(</span> <span class="token variable">$post_id</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token string single-quoted-string">'Object Title: '</span> <span class="token operator">.</span> <span class="token variable">$post</span><span class="token operator">-></span><span class="token property">post_title</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'&lt;br>'</span><span class="token punctuation">;</span>

<span class="token comment">// get post - return post data as an array</span>
<span class="token variable">$post</span> <span class="token operator">=</span> <span class="token function">get_post</span><span class="token punctuation">(</span> <span class="token variable">$post_id</span><span class="token punctuation">,</span> <span class="token constant">ARRAY_A</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token string single-quoted-string">'Array Title: '</span> <span class="token operator">.</span> <span class="token variable">$post</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'post_title'</span><span class="token punctuation">]</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'&lt;br>'</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><strong>get_posts( $args = null ) 取得文章列表</strong></p>
<p>當要取得文章清單時，像是最新文章列表、特定分類列表就可以使用這支 Function。它是根據 WP_Query 類別所設計的。$args 參數可以用陣列的方式來提供文章取得條件，範例如下：</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token comment">// get posts - return 100 posts</span>
<span class="token variable">$posts</span> <span class="token operator">=</span> <span class="token function">get_posts</span><span class="token punctuation">(</span> <span class="token keyword">array</span><span class="token punctuation">(</span>
  <span class="token string single-quoted-string">'numberposts'</span> <span class="token operator">=></span> <span class="token string single-quoted-string">'100'</span><span class="token punctuation">,</span> <span class="token comment">// 顯示文章數量</span>
  <span class="token string single-quoted-string">'category'</span>         <span class="token operator">=></span> <span class="token number">0</span><span class="token punctuation">,</span>  <span class="token comment">// 文章分類 ID</span>
        <span class="token string single-quoted-string">'orderby'</span>          <span class="token operator">=></span> <span class="token string single-quoted-string">'date'</span><span class="token punctuation">,</span>  <span class="token comment">// 排序條件</span>
        <span class="token string single-quoted-string">'order'</span>            <span class="token operator">=></span> <span class="token string single-quoted-string">'DESC'</span><span class="token punctuation">,</span>  <span class="token comment">// 排序方式，DESC 為降冪，ASC 為升冪</span>
        <span class="token string single-quoted-string">'include'</span>          <span class="token operator">=></span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment">// 只顯示特定的文章</span>
        <span class="token string single-quoted-string">'exclude'</span>          <span class="token operator">=></span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment">// 排除指定文章</span>
        <span class="token string single-quoted-string">'meta_key'</span>         <span class="token operator">=></span> <span class="token string single-quoted-string">''</span><span class="token punctuation">,</span>  <span class="token comment">// 顯示帶有指定欄位的文章</span>
        <span class="token string single-quoted-string">'meta_value'</span>       <span class="token operator">=></span> <span class="token string single-quoted-string">''</span><span class="token punctuation">,</span>  <span class="token comment">// 顯示帶有指定欄位值的文章</span>
        <span class="token string single-quoted-string">'post_type'</span>        <span class="token operator">=></span> <span class="token string single-quoted-string">'post'</span><span class="token punctuation">,</span>  <span class="token comment">// 文章類型</span>
        <span class="token string single-quoted-string">'suppress_filters'</span> <span class="token operator">=></span> <span class="token constant boolean">true</span><span class="token punctuation">,</span>  <span class="token comment">// 如果需要使用 filter 來修改 get_posts 的結果，這個參數要設為 false</span>
<span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// loop all posts and display the ID &amp; title</span>
<span class="token keyword">foreach</span> <span class="token punctuation">(</span> <span class="token variable">$posts</span> <span class="token keyword">as</span> <span class="token variable">$post</span> <span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">echo</span> <span class="token variable">$post</span><span class="token operator">-></span><span class="token constant">ID</span> <span class="token operator">.</span> <span class="token string single-quoted-string">': '</span> <span class="token operator">.</span><span class="token variable">$post</span><span class="token operator">-></span><span class="token property">post_title</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'&lt;br>'</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><strong>wp_delete_post( $postid=0, $force_delete =false ) 刪除指定文章</strong></p>
<p>第一個參數為要刪除的文章 ID，第二個參數如果為 true 的話，文章就不會進垃圾桶而直接被刪除，代表連救回來的機會都沒有，預設值為 false，範例如下：</p>
<p>// delete post - skip the trash and permanently delete it<br>wp_delete_post( $post_id, true );</p>
<hr>
<p><strong>（五）wp_postmeta</strong> - 文章自訂欄位</p>
<p>如果內建的文章欄位不夠用，想要新增其他欄位的話就會寫在這張表中。WordPress 提供很方便的作法讓你不用再自行增加資料表，每個欄位使用 post_id 來對應到文章。</p>
<p>如果你需要新增欄位但又不想讓使用者在文章編輯畫面看到該欄位，可以用下底線開頭的欄位名稱，這樣 WordPress 會自動在後台隱藏這個欄位而不被使用者看見。</p>
<blockquote>
<p>寫到這張表的時候就想到一件事，每次使用 ACF 開了一堆欄位，當網站開始上大量的資料之後，這張表就會以飛快的速度開始爆肥，因為所有的自訂欄位全部都會塞在裡面，這對於在 DB Query 上會是不小的負擔。</p>
<p>好奇的查了一下有沒有可以把 ACF 欄位獨立成一張表的外掛，想不到還真的有！一間澳洲的公司叫做 Hookturn，他們開發了一隻外掛叫做 <a target="_blank" rel="noopener" href="https://hookturn.io/downloads/acf-custom-database-tables/">ACF Custom Database Tables</a>，看影片介紹非常猛，完全就是我想像的功能，售價 139 鎂，對於有規模的網站來說，絕對比再多開兩台 DB 來得划算的多！</p>
<p>Hookturn 還有另外兩隻外掛商品，一隻很實用，直接幫你把欄位的 PHP 產好，另外一隻我覺得根本就是 ACF 應該要內建的功能：<a target="_blank" rel="noopener" href="https://hookturn.io/downloads/advanced-forms-pro/">前台表單</a>。它可以把 ACF 的欄位完整呈現在前台，這個拿來做 Web App 超級方便，就不用自己在那邊刻表單刻個老半天了，下一個 Web App 我一定會用它！</p>
</blockquote>
<p><img src="https://oberonlai.blog/wp-content/uploads/2020/03/CleanShot-2020-03-27-at-09.51.32-1024x126.jpg"></p>
<p>wp_postmeta 資料表結構</p>
<p><strong>get_post_meta( $post_id, $meta_key, $single=false ) 取得文章欄位值</strong></p>
<p>第一個參數為文章 ID，第二個為欄位名稱，如果留空值，會回傳所有相同 $meta_key 的 $meta_value，$single 為 true 的話會以字串回傳符合第一個 $meta_key 的 $meta_value，false 的話則會使用陣列回傳所有符合的 $meta_value，範例如下：</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token comment">// get post meta - get 1st instance of key</span>
<span class="token variable">$student</span> <span class="token operator">=</span> <span class="token function">get_post_meta</span><span class="token punctuation">(</span> <span class="token variable">$post_id</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'bwawwp_student'</span><span class="token punctuation">,</span> <span class="token constant boolean">true</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token string single-quoted-string">'oldest student: '</span> <span class="token operator">.</span> <span class="token variable">$student</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p><strong>update_post_meta( $post_id, $meta_key, $meta_value, $prev_value=’’) 更新文章欄位</strong></p>
<p>需要注意的是第四個參數，如果 $meta_key 有多筆符合，在 $prev_value 為空的情況下，$meta_value 只會修改第一筆 $meta_key，如果 $prev_value 有符合多筆 $meta_key 的 $meta_value 其中一筆，則這一筆的 value 會被第三個 $meta_value 給取代掉。範例如下：</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token comment">// update post meta - public metadata</span>
<span class="token variable">$content</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'You SHOULD see this custom field when editing your latest post.'</span><span class="token punctuation">;</span>
<span class="token function">update_post_meta</span><span class="token punctuation">(</span> <span class="token variable">$post_id</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'bwawwp_displayed_field'</span><span class="token punctuation">,</span> <span class="token variable">$content</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// update post meta - hidden metadata</span>
<span class="token variable">$content</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span> <span class="token string single-quoted-string">'SHOULD'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'SHOULD NOT'</span><span class="token punctuation">,</span> <span class="token variable">$content</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">update_post_meta</span><span class="token punctuation">(</span> <span class="token variable">$post_id</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'_bwawwp_hidden_field'</span><span class="token punctuation">,</span> <span class="token variable">$content</span> <span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><strong>add_post_meta( $post_id, $meta_key, $meta_value, $unique=false)</strong></p>
<p>習慣上新增文章欄位會使用 update_post_meta()，因為它有判斷 $meta_key 是否存在的功能，會用 add_post_meta 的情境在於要新增多筆 $meat_value 到相同的 $meta_key。第四個參數 $unique 為 true 時代表不允許有多筆相同的 $meta_key，範例如下：</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token function">add_post_meta</span><span class="token punctuation">(</span> <span class="token variable">$post_id</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'bwawwp_students'</span><span class="token punctuation">,</span> <span class="token variable">$students</span><span class="token punctuation">,</span> <span class="token constant boolean">true</span> <span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><strong>delete_post_meta( $post_id, $meta_key, $meta_value=’’ ) 刪除文章欄位</strong></p>
<p>第三個參數當有指定 $meta_value 只會刪除符合該 value 的 $meta_key，範例如下</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token comment">// delete post meta</span>
<span class="token function">delete_post_meta</span><span class="token punctuation">(</span> <span class="token variable">$post_id</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'bwawwp_student'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<hr>
<p><strong>（六）wp_comments</strong> - 紀錄文章留言的資料表</p>
<p><img src="https://oberonlai.blog/wp-content/uploads/2020/03/CleanShot-2020-03-30-at-10.05.06-1024x349.jpg"></p>
<p>wp_comments 資料表結構</p>
<p>wp_comments 相關的 Function 定義在 wp-include/comment.php，常用的如下：</p>
<p><strong>get_comment( $comment, $output=OBJECT ) 根據留言 ID 取得留言內容</strong></p>
<p>第一個參數可以為留言 ID 或是 OBJECT，第二個為返回格式，可以為 OBJECT、ARRAY_A 與 ARRAY_n。範例如下：</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token comment">// make comments array</span>
<span class="token variable">$comments</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'ICE CREAM!!!!'</span><span class="token punctuation">;</span>
<span class="token variable">$comments</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'Taco Bell'</span><span class="token punctuation">;</span>
<span class="token variable">$comments</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'Get a good night sleep'</span><span class="token punctuation">;</span>

<span class="token comment">//loop comments array</span>
<span class="token keyword">foreach</span> <span class="token punctuation">(</span> <span class="token variable">$comments</span> <span class="token keyword">as</span> <span class="token variable">$key</span> <span class="token operator">=></span> <span class="token variable">$comment</span> <span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token comment">// insert comments</span>
    <span class="token variable">$commentdata</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span>
        <span class="token string single-quoted-string">'comment_post_ID'</span> <span class="token operator">=></span> <span class="token variable">$post_id</span><span class="token punctuation">,</span>
        <span class="token string single-quoted-string">'comment_content'</span> <span class="token operator">=></span> <span class="token variable">$comments</span><span class="token punctuation">[</span><span class="token variable">$key</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$comment_ids</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">wp_insert_comment</span><span class="token punctuation">(</span> <span class="token variable">$commentdata</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 插入留言</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// get comment - get best comment</span>
<span class="token variable">$comment</span> <span class="token operator">=</span> <span class="token function">get_comment</span><span class="token punctuation">(</span> <span class="token variable">$comment_ids</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token string single-quoted-string">'best comment: '</span> <span class="token operator">.</span> <span class="token variable">$comment</span><span class="token operator">-></span><span class="token property">comment_content</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><strong>get_comments( $args=’’ ) 取得特定文章的留言列表</strong></p>
<p>該 Funciton 使用 WP_Coomen_Query 類別來取得留言，$args 為選填的陣列或是用 &amp; 符號連結的字串來取留言，常用參數有：</p>
<ul>
<li>  author_email 留言者的電子郵件</li>
<li>  ID 留言 ID</li>
<li>  karma 留言評價</li>
<li>  number 顯示留言筆數</li>
<li>  offset 跳過顯示留言比數</li>
<li>  orderby 排序條件，可選的值有 ‘comment_agent’,’comment_approved’,’comment_author’,’comment_author_email’,’comment_author_IP’,’comment_author_url’,’comment_content’,’comment_date’,’comment_date_gmt’,’comment_ID’,’comment_karma’,’comment_parent’,’comment_post_ID’,’comment_type’,’user_id’,’comment__in’,’meta_value’,’meta_value_num’</li>
<li>  order 排序方式，可選值為 DESC 與 ASC</li>
<li>  parent 父留言的 id (comment 有階層)</li>
<li>  post_id 特定文章的留言</li>
<li>  post_author 文章作者</li>
<li>  post_name 文章名稱</li>
<li>  post_parent 父文章</li>
<li>  post_status 文章狀態</li>
<li>  post_type 文章類型</li>
<li>  status 留言狀態，可選值有 hode, approve, spam, trash</li>
<li>  type 留言類型，可選值有 pingback, trackback</li>
<li>  user_id 留言者的 id</li>
<li>  search 可針對留言的欄位進行關鍵字搜尋，搜尋範圍有：comment_author, comment_author_email, comment_author_url, comment_author_IP, comment_content</li>
<li>  count 當為 true 時返回符合 query 條件的留言筆數，false 時返為留言 Object，預設為 false</li>
<li>  meta_key 留言 meta 的 key</li>
<li>  meta_value 留言 meta 的 value</li>
</ul>
<p>範例如下：</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token variable">$comment_count</span> <span class="token operator">=</span> <span class="token function">get_comments</span><span class="token punctuation">(</span> <span class="token string single-quoted-string">'post_id= '</span> <span class="token operator">.</span> <span class="token variable">$post_id</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'&amp;count=true'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token string single-quoted-string">'comment count: '</span> <span class="token operator">.</span> <span class="token variable">$comment_count</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'&lt;br>'</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<blockquote>
<p>一直對 Karma 那個參數很在意，因為從來沒看過 WP 留言內建有什麼評價機制，查了很多都沒有具體的使用範例，最後查到<a target="_blank" rel="noopener" href="https://wordpress.stackexchange.com/questions/199950/what-is-comment-karma">這一篇</a>是說資料表裡面有一個叫 comment_karma 的欄位，是用來做防止垃圾留言機制的，但現在都沒人會用這個欄位來做留言評價的功能，所以我想應該是早期 WordPress 留下來的產物，而為了要相容舊版所以就擺在那邊了，真要做留言評分的話還是用 comment meta 來處理。</p>
</blockquote>
<p><strong>wp_insert_comment( $commentdata ) 新增留言</strong></p>
<p>$commentdata 為新增留言需要提供的參數，新增完成後會返回留言 ID，範例如下：</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token comment">// insert comment - sub comment from parent id</span>
<span class="token variable">$commentdata</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span>
<span class="token string single-quoted-string">'comment_post_ID'</span> <span class="token operator">=></span> <span class="token variable">$post_id</span><span class="token punctuation">,</span> <span class="token comment">// 指定文章</span>
<span class="token string single-quoted-string">'comment_parent'</span> <span class="token operator">=></span> <span class="token variable">$comment_ids</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// 指定父留言</span>
<span class="token string single-quoted-string">'comment_content'</span> <span class="token operator">=></span> <span class="token string single-quoted-string">'That is a pretty good idea...'</span><span class="token punctuation">,</span> <span class="token comment">// 留言內容</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">wp_insert_comment</span><span class="token punctuation">(</span> <span class="token variable">$commentdata</span> <span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>其他參數還有：comment_author, comment_author_email, comment_author_url, comment_author_IP, comment_date, comment_date_gmt, comment_karma, comment_approved, comment_agent, comment_type, comment_parent 與 user_id。</p>
<p><strong>wp_delete_comment( $comment_id, $force_delete=false) 刪除留言</strong></p>
<p>需要注意的是第二個參數，為 true 的話就會直接被永久刪除而無法從垃圾桶找回，範例如下：</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token comment">// delete comment</span>
<span class="token function">wp_delete_comment</span><span class="token punctuation">(</span> <span class="token variable">$comment</span><span class="token operator">-></span><span class="token property">comment_ID</span><span class="token punctuation">,</span> <span class="token constant boolean">true</span> <span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<hr>
<p><strong>（七）wp_commentmeta</strong> - 留言自訂欄位</p>
<p><img src="https://oberonlai.blog/wp-content/uploads/2020/03/CleanShot-2020-03-31-at-10.15.35-1024x124.jpg"></p>
<p>wp_commentmeta 資料表結構</p>
<p>wp_commentmeta 相關的 Function 定義在 wp-include/comment.php，常用的如下：</p>
<p><strong>get_comment_meta( $comment_id, $meta_key, $single = false ) 取得留言自訂欄位</strong></p>
<p>第一個參數為留言 ID，第二個為欄位名稱，如果留空值，會回傳所有相同 $meta_key 的 $meta_value，$single 為 true 的話會以字串回傳符合第一個 $meta_key 的 $meta_value，false 的話則會使用陣列回傳所有符合的 $meta_value，範例如下：</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token comment">// get comment meta - all keys</span>
<span class="token variable">$comment_meta</span> <span class="token operator">=</span> <span class="token function">get_comment_meta</span><span class="token punctuation">(</span> <span class="token variable">$comment_id</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token string single-quoted-string">'&lt;pre>'</span><span class="token punctuation">;</span>
<span class="token function">print_r</span><span class="token punctuation">(</span> <span class="token variable">$comment_meta</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token string single-quoted-string">'&lt;/pre>'</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><strong>add_comment_meta( $comment_id, $meta_key, $meta_value, $unique=false ) 新增留言自訂欄位</strong></p>
<p>第四個參數 $unique 為 true 時代表不允許有多筆相同的 $meta_key，範例如下：</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token comment">// add comment meta - meta for view date &amp; IP address</span>
<span class="token variable">$viewed</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span> <span class="token function">date</span><span class="token punctuation">(</span> <span class="token string double-quoted-string">"m.d.y"</span> <span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"REMOTE_ADDR"</span><span class="token punctuation">]</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$comment_meta_id</span> <span class="token operator">=</span> <span class="token function">add_comment_meta</span><span class="token punctuation">(</span> <span class="token variable">$comment_id</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'bwawwp_view_date'</span><span class="token punctuation">,</span> <span class="token variable">$viewed</span><span class="token punctuation">,</span> <span class="token constant boolean">true</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token string single-quoted-string">'comment meta id: '</span> <span class="token operator">.</span> <span class="token variable">$comment_meta_id</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p><strong>update_comment_meta( $comment_id, $meta_key, $meta_value, $prev_value=’’) 更新留言自訂欄位</strong></p>
<p>第四個參數跟其他 xxx_meta 一樣，如果 $meta_key 有多筆符合，在 $prev_value 為空的情況下，$meta_value 只會修改第一筆 $meta_key，如果 $prev_value 有符合多筆 $meta_key 的 $meta_value 其中一筆，則這一筆的 value 會被第三個 $meta_value 給取代掉。範例如下：</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token comment">// update comment meta - change date format to format like</span>
<span class="token comment">// October 23, 2020, 12:00 am instead of 10.23.20</span>
<span class="token variable">$viewed</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span> <span class="token function">date</span><span class="token punctuation">(</span> <span class="token string double-quoted-string">"F j, Y, g:i a"</span> <span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"REMOTE_ADDR"</span><span class="token punctuation">]</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">update_comment_meta</span><span class="token punctuation">(</span> <span class="token variable">$comment_id</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'bwawwp_view_date'</span><span class="token punctuation">,</span> <span class="token variable">$viewed</span> <span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p><strong>delete_comment_meta( $comment_id, $meta_key, $meta_value=’’ ) 刪除留言欄位</strong></p>
<p>第三個參數當有指定 $meta_value 只會刪除符合該 value 的 $meta_key，範例如下：</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token comment">// delete comment meta</span>
<span class="token function">delete_comment_meta</span><span class="token punctuation">(</span> <span class="token variable">$comment_id</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'bwawwp_view_date'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<hr>
<p><strong>（八）wp_temrs</strong> - 該表放了文章分類 ( Category ) 名稱或是自訂分類項目 ( Term ) 的名稱，每一個分類項目都會綁定一個主分類 ( Taxonomy )。常用的文章分類與文章標籤都是一種主分類，主分類底下新增的叫做分類項目。</p>
<blockquote>
<p>這邊很容易讓人搞不清楚，因為不管是 Catergory 還是 Taxonomy 中文都叫「分類」，然後中間還多一個叫 term 的東西 Orz…</p>
<p>後來我的理解方式是只要記得<strong>主類別 Taxonomy</strong>、<strong>分類項目 Term</strong> 就好，譬如主類別是水果 ( Taxonomy )，分類項目 ( Term ) 有溫熱性水果、涼性水果、中性水果等等，至於 Category 則是文章的主類別，Tag 也是文章的主類別，一個文章類型可以有多個主類別。</p>
<p>順帶一提，Category 與 Tag 在技術面上的差異是前者可以有階層關係，而後者只會有一層。</p>
</blockquote>
<p><img src="https://oberonlai.blog/wp-content/uploads/2020/03/CleanShot-2020-03-31-at-10.53.05.jpg"></p>
<p>文章的分類與標籤</p>
<p><img src="https://oberonlai.blog/wp-content/uploads/2020/03/CleanShot-2020-03-31-at-10.56.14-1024x123.jpg"></p>
<p>wp_terms 資料表結構</p>
<p>wp_terms 相關的 Function 定義在 wp-includes/taxonomy.php，常用的如下：</p>
<p><strong>get_terms( $arg=’’ ) 取得單一或多個主類別的分類項目</strong></p>
<blockquote>
<p>書中說明為 get_terms( $taxonomies, $args= ‘’ )，但查<a target="_blank" rel="noopener" href="https://developer.wordpress.org/reference/functions/get_terms/">官方文件</a>指出這是 WP 4.5 版之前的寫法，之後的寫法要把 $taxonomies 放在 $args 裡面，該出以官方文件為準。</p>
</blockquote>
<p>$arg 參數為帶入篩選屬性，相關屬性有：</p>
<ul>
<li>  taxonomy - 主分類名稱，可以用 array 帶入多筆主分類</li>
<li>  orderby - 排序條件，可以是 name、count、term_group、slug，預設是 name</li>
<li>  order - 排序方式，可選值為 ASC 升冪與 DESC 降冪預設為 ASC</li>
<li>  hide_empty - 隱藏所屬文章篇數為 0 的分類項目</li>
<li>  exclude - 排除分類項目</li>
<li>  exclude_tree 排除分類項目以及它的子分類項目</li>
<li>  include - 只顯示指定的分類項目</li>
<li>  number - 設定顯設筆數</li>
<li>  offset - 設定跳過筆數</li>
<li>  fields - 選擇返回分類項目 ID 或是名稱，預設是兩個都返回</li>
<li>  slug - 只顯示符合指定代稱的分類名稱</li>
<li>  hierarchical - 顯示所以分類項目的子分類項目，預設為 true</li>
<li>  search - 搜尋符合指定字串為分類項目名稱的結果，英文字母不區分大小寫</li>
<li>  name_like - 搜尋符合開頭為指定字串的分類項目名稱結果，英文字母不區分大小寫</li>
<li>  pad_counts - 預設為 true，會返回每個分類項目帶有多少子項目的數量</li>
<li>  get - 設定為 all 時，會返回所有父項目或是空的分類項目</li>
<li>  child_of - 取得特定分類項目的子項目</li>
<li>  parent - 取得子項目的父分類項目</li>
<li>  cache_domain - 啟用的話會把查詢結果存在 object cache 之中，以節省重複查詢的時間</li>
</ul>
<p>範例如下：</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token variable">$terms</span> <span class="token operator">=</span> <span class="token function">get_terms</span><span class="token punctuation">(</span> <span class="token keyword">array</span><span class="token punctuation">(</span>
    <span class="token string single-quoted-string">'taxonomy'</span> <span class="token operator">=></span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'post_tag'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'category'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token string single-quoted-string">'hide_empty'</span> <span class="token operator">=></span> <span class="token constant boolean">false</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p><strong>get_term( $term, $taxonomy, $outpug= OBJECT, $filter=’raw’ ) 取得分類項目的所有資訊</strong></p>
<p>第一個參數可以是 term ID 或是 term Object，預設值為 0，會回傳所有的項目，第二個參數是該項目所屬的主分類，</p>
<p>$output 資料格式可以設定為 OBJECT 或是 ARRAY_A (關聯式陣列) 與 ARRAY_N(索引式陣列)。$filter 參數為設定要 sanitize 的模式，可選值有 raw、edit、db、display、attribute 與 js，這是與安全性有關的議題，會在第八章的時候提到。範例如下：</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token variable">$term</span> <span class="token operator">=</span> <span class="token function">get_term</span><span class="token punctuation">(</span> <span class="token number">1</span> <span class="token punctuation">,</span> <span class="token string single-quoted-string">'category'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token variable">$term</span><span class="token operator">-></span><span class="token property">name</span><span class="token punctuation">;</span>  <span class="token comment">// 顯示分類項目名稱</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p><strong>wp_insert_term( $term, $taxonomy, $args=array() ) 新增分類項目</strong></p>
<p>第一個參數為分類項目名稱，如果已經存在的話會更新既有的，第二個參數為所屬主分類，第三個為分類項目的資料，可用參數如下：</p>
<ul>
<li>  alias_of - 分類項目的別名</li>
<li>  description - 分類項目的描述</li>
<li>  parent - 指定所屬父分類項目 ID</li>
<li>  slug - 分類項目代稱</li>
</ul>
<p>範例如下：</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token variable">$parent_term</span> <span class="token operator">=</span> <span class="token function">term_exists</span><span class="token punctuation">(</span> <span class="token string single-quoted-string">'fruits'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'product'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// array is returned if taxonomy is given</span>
<span class="token variable">$parent_term_id</span> <span class="token operator">=</span> <span class="token variable">$parent_term</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'term_id'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>         <span class="token comment">// get numeric term id</span>
<span class="token function">wp_insert_term</span><span class="token punctuation">(</span>
    <span class="token string single-quoted-string">'Apple'</span><span class="token punctuation">,</span>   <span class="token comment">// the term </span>
    <span class="token string single-quoted-string">'product'</span><span class="token punctuation">,</span> <span class="token comment">// the taxonomy</span>
    <span class="token keyword">array</span><span class="token punctuation">(</span>
        <span class="token string single-quoted-string">'description'</span> <span class="token operator">=></span> <span class="token string single-quoted-string">'A yummy apple.'</span><span class="token punctuation">,</span>
        <span class="token string single-quoted-string">'slug'</span>        <span class="token operator">=></span> <span class="token string single-quoted-string">'apple'</span><span class="token punctuation">,</span>
        <span class="token string single-quoted-string">'parent'</span>      <span class="token operator">=></span> <span class="token variable">$parent_term_id</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><strong>wp_update_term( $term_id, $taxonomy, $args=array() ) 更新分類項目資料</strong></p>
<p>更新現有分類項目的資料，範例如下：</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token variable">$update</span> <span class="token operator">=</span> <span class="token function">wp_update_term</span><span class="token punctuation">(</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'category'</span><span class="token punctuation">,</span> <span class="token keyword">array</span><span class="token punctuation">(</span>
    <span class="token string single-quoted-string">'name'</span> <span class="token operator">=></span> <span class="token string single-quoted-string">'Non Catégorisé'</span><span class="token punctuation">,</span>
    <span class="token string single-quoted-string">'slug'</span> <span class="token operator">=></span> <span class="token string single-quoted-string">'non-categorise'</span>
<span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p><strong>wp_delete_term( $term, $taxonomy, $args=array() ) 刪除分類項目</strong></p>
<p>第三個參數帶有兩個屬性，default 以及 force_default，來決定預設的分類項目。</p>
<hr>
<p><strong>（九）wp_termmeta</strong> - 分類項目的自訂欄位</p>
<p>從 WordPress 4.4 版之後就可以自訂分類項目的欄位，運用的場景可以像是決定分類項目的排列順序，或是其他任何需要擴充分類項目欄位的應用上。</p>
<p><img src="https://oberonlai.blog/wp-content/uploads/2020/04/CleanShot-2020-04-01-at-10.04.09-1024x117.jpg"></p>
<p>wp_termmeta 資料表結構</p>
<p>相關的 Function 與其他 user meta、post meta、comment meta 很像，說明如下：</p>
<p><strong>get_term_meta( $term_id, $meta_key=’’, $single=false ) 取得分類項目自訂欄位</strong></p>
<p>第一個參數為留言 ID，第二個為欄位名稱，如果留空值，會回傳所有相同 $meta_key 的 $meta_value，$single 為 true 的話會以字串回傳符合第一個 $meta_key 的 $meta_value，false 的話則會使用陣列回傳所有符合的 $meta_value。</p>
<p><strong>update_term_meta( $term_id, $meta_key, $meta_value, $prev_value=’’ ) 更新分類項目自訂欄位</strong></p>
<p>第四個參數跟其他 xxx_meta 一樣，如果 $meta_key 有多筆符合，在 $prev_value 為空的情況下，$meta_value 只會修改第一筆 $meta_key，如果 $prev_value 有符合多筆 $meta_key 的 $meta_value 其中一筆，則這一筆的 value 會被第三個 $meta_value 給取代掉。</p>
<p><strong>add_term_meta( $term_id, $meta_key, $meta_value, $unique=false ) 新增分類項目自訂欄位</strong></p>
<p>第四個參數 $unique 為 true 時代表不允許有多筆相同的 $meta_key。</p>
<p><strong>delete_term_meta( $term_id, $meta_key, $meta_value=’’) 刪除分類項目自訂欄位</strong></p>
<p>第三個參數當有指定 $meta_value 只會刪除符合該 value 的 $meta_key。</p>
<hr>
<p><strong>（十）wp_term_taxonomy</strong> - 存放主分類 Taxonomy 的資料表</p>
<p>當有分類項目 Term 新增的時候，一定會綁定一個主分類 Taxonomy，WordPress 預設的主分類有 category 與 post_tag。</p>
<p><img src="https://oberonlai.blog/wp-content/uploads/2020/04/CleanShot-2020-04-02-at-09.21.44-1024x165.jpg"></p>
<p>wp_term_taxonomy 資料表結構</p>
<p>wp_term_taxonomy 相關 Function 定義在 wp-includes/taxonomy.php，常用如下：</p>
<p><strong>get_taxonomies( $args=array(), $output=’names’, $operator=’and’ ) 取得主分類清單</strong></p>
<p>$args 可以帶入參數來篩選清單，詳細用法第五章會說明，$output 為設定返回格式，預設 names 會返回主分類名稱，或是 objects 返回主分類物件。</p>
<p>$operator 參數可以選擇 and 或是 or，差別在於是否完全符合或是部分符合第一個傳入參數的內容，範例如下：</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token variable">$args</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span>
  <span class="token string single-quoted-string">'public'</span>   <span class="token operator">=></span> <span class="token constant boolean">true</span><span class="token punctuation">,</span>
  <span class="token string single-quoted-string">'_builtin'</span> <span class="token operator">=></span> <span class="token constant boolean">false</span>
   
<span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token variable">$output</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'names'</span><span class="token punctuation">;</span> <span class="token comment">// or objects</span>
<span class="token variable">$operator</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'and'</span><span class="token punctuation">;</span> <span class="token comment">// 'and' or 'or'</span>
<span class="token variable">$taxonomies</span> <span class="token operator">=</span> <span class="token function">get_taxonomies</span><span class="token punctuation">(</span> <span class="token variable">$args</span><span class="token punctuation">,</span> <span class="token variable">$output</span><span class="token punctuation">,</span> <span class="token variable">$operator</span> <span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token variable">$taxonomies</span> <span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">echo</span> <span class="token string single-quoted-string">'&lt;ul>'</span><span class="token punctuation">;</span>
    <span class="token keyword">foreach</span> <span class="token punctuation">(</span> <span class="token variable">$taxonomies</span>  <span class="token keyword">as</span> <span class="token variable">$taxonomy</span> <span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">echo</span> <span class="token string single-quoted-string">'&lt;li>'</span> <span class="token operator">.</span> <span class="token variable">$taxonomy</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'&lt;/li>'</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">echo</span> <span class="token string single-quoted-string">'&lt;/ul>'</span><span class="token punctuation">;</span> 
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><strong>get_taxonomy( $taxonomy ) 取得特定主分類</strong></p>
<p>$taxonomy 為主分類名稱，範例如下：</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token variable">$rental_features</span> <span class="token operator">=</span> <span class="token function">get_taxonomy</span><span class="token punctuation">(</span> <span class="token string single-quoted-string">'features'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">print_r</span><span class="token punctuation">(</span> <span class="token variable">$rental_features</span> <span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<blockquote>
<p>這邊提到的主分類名稱或是 name 是指定義 Taxonomy 的英文名，而非顯示在後台的中文名字。</p>
</blockquote>
<p><strong>register_taxonomy( $taxonomy, $object_type, $args=array() ) 註冊新的主分類</strong></p>
<p>如果你覺得文章只有 category 跟 post_tag 這兩個主分類不夠用，或是自定義文章需要主分類時，就可以用這支來做新增，$taxonomy 為主分類名稱，必須是英文，中文名字會在 $args 裡面的 label 來定義。</p>
<p>$object_type 是定義要把這個主分類綁定到哪一個文章類型上面，$args 有一堆參數來設定主分類的資料，像是上面提到的中文名字就是在這邊設定，更多詳細內容會在第五章介紹，或是看 <a target="_blank" rel="noopener" href="https://codex.wordpress.org/Function_Reference/register_taxonomy">Codex 文件</a>有完整的說明。基本範例如下：</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token function">add_action</span><span class="token punctuation">(</span> <span class="token string single-quoted-string">'init'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'create_book_tax'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">create_book_tax</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token function">register_taxonomy</span><span class="token punctuation">(</span>
        <span class="token string single-quoted-string">'genre'</span><span class="token punctuation">,</span>  <span class="token comment">// 主分類名稱</span>
        <span class="token string single-quoted-string">'book'</span><span class="token punctuation">,</span>   <span class="token comment">// 文章類型</span>
        <span class="token keyword">array</span><span class="token punctuation">(</span>
            <span class="token string single-quoted-string">'label'</span> <span class="token operator">=></span> <span class="token function">__</span><span class="token punctuation">(</span> <span class="token string single-quoted-string">'書的分類'</span> <span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// 主分類顯示名稱</span>
            <span class="token string single-quoted-string">'rewrite'</span> <span class="token operator">=></span> <span class="token keyword">array</span><span class="token punctuation">(</span> <span class="token string single-quoted-string">'slug'</span> <span class="token operator">=></span> <span class="token string single-quoted-string">'genre'</span> <span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token string single-quoted-string">'hierarchical'</span> <span class="token operator">=></span> <span class="token constant boolean">true</span><span class="token punctuation">,</span>
        <span class="token punctuation">)</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<blockquote>
<p>書中提到之前有在討論是否該移除 wp_terms 這張表，然後把裡面的欄位移到 wp_terms_taxonomy，但後來還是為了相容性而作罷，還好沒移掉，不然手上一堆網站會爆炸@@</p>
</blockquote>
<hr>
<p><strong>（十一）wp_term_relationships</strong> - 紀錄 post 與 Taxonomy 綁定關係的資料表</p>
<p>當使用 register_taxonomy() 的時候，第二個參數會指定文章類型，指定後就會紀錄在這張表之中。</p>
<p><img src="https://oberonlai.blog/wp-content/uploads/2020/04/CleanShot-2020-04-02-at-09.50.41.jpg"></p>
<p>wp_term_relationships 資料表結構</p>
<p>wp_term_relationships 常用 Function 如下：</p>
<p><strong>get_object_taxonomies( $object, $output=’names’ ) 取得特定文章類型所擁有的主分類</strong></p>
<p>第一個參數為文章類型名稱，第二個參數為設定返回格式，可以是 names 或 objects，範例如下：</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token variable">$taxonomy_names</span> <span class="token operator">=</span> <span class="token function">get_object_taxonomies</span><span class="token punctuation">(</span> <span class="token string single-quoted-string">'post'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">print_r</span><span class="token punctuation">(</span> <span class="token variable">$taxonomy_names</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p><strong>wp_get_object_terms( $object_ids, $taxonomies, $args= array() ) 取得特定文章類型特定主分類的分類項目</strong></p>
<p>第一個參數為文章 ID，可以是字串或陣列。第二個參數是主分類名稱，可以是字串或陣列，第三個是選填的篩選參數，可以用的屬性有：</p>
<ul>
<li>  orderby - 排序條件，可依照 slug、term_group、term_order 來進行排序</li>
<li>  order - 排序方式，可設定 ASC 升冪與 DESC 降冪</li>
<li>  fields - 分類項目欄位，可選值有 ids、names、slugs 以及 all_with_object_id</li>
</ul>
<p>範例如下：</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token variable">$product_terms</span> <span class="token operator">=</span> <span class="token function">wp_get_object_terms</span><span class="token punctuation">(</span> <span class="token variable">$post</span><span class="token operator">-></span><span class="token constant">ID</span><span class="token punctuation">,</span>  <span class="token string single-quoted-string">'product'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
 
<span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token operator">!</span> <span class="token keyword">empty</span><span class="token punctuation">(</span> <span class="token variable">$product_terms</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token operator">!</span> <span class="token function">is_wp_error</span><span class="token punctuation">(</span> <span class="token variable">$product_terms</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">echo</span> <span class="token string single-quoted-string">'&lt;ul>'</span><span class="token punctuation">;</span>
            <span class="token keyword">foreach</span><span class="token punctuation">(</span> <span class="token variable">$product_terms</span> <span class="token keyword">as</span> <span class="token variable">$term</span> <span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                <span class="token keyword">echo</span> <span class="token string single-quoted-string">'&lt;li>&lt;a href="'</span> <span class="token operator">.</span> <span class="token function">esc_url</span><span class="token punctuation">(</span> <span class="token function">get_term_link</span><span class="token punctuation">(</span> <span class="token variable">$term</span><span class="token operator">-></span><span class="token property">slug</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'product'</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'">'</span> <span class="token operator">.</span> <span class="token function">esc_html</span><span class="token punctuation">(</span> <span class="token variable">$term</span><span class="token operator">-></span><span class="token property">name</span> <span class="token punctuation">)</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'&lt;/a>&lt;/li>'</span><span class="token punctuation">;</span> 
            <span class="token punctuation">&#125;</span>
        <span class="token keyword">echo</span> <span class="token string single-quoted-string">'&lt;/ul>'</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><strong>wp_set_object_terms( $object_id, $terms, $taxonomy, $append=false ) 新增特定文章特定主分類的分類項目</strong></p>
<p>需要注意的是第四個參數，在預設情況下如果設定的分類項目名撐已經存在，則會自動取代，反之則會保留既有的在新增一筆分類項目。範例如下：</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token comment">// An array of IDs of categories we want this post to have.</span>
<span class="token variable">$cat_ids</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">8</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
 
<span class="token comment">/*
 * If this was coming from the database or another source, we would need to make sure
 * these were integers:
 
$cat_ids = array_map( 'intval', $cat_ids );
$cat_ids = array_unique( $cat_ids );
 
 */</span>
 
<span class="token variable">$term_taxonomy_ids</span> <span class="token operator">=</span> <span class="token function">wp_set_object_terms</span><span class="token punctuation">(</span> <span class="token number">42</span><span class="token punctuation">,</span> <span class="token variable">$cat_ids</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'category'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
 
<span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token function">is_wp_error</span><span class="token punctuation">(</span> <span class="token variable">$term_taxonomy_ids</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token comment">// There was an error somewhere and the terms couldn't be set.</span>
<span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
    <span class="token comment">// Success! The post's categories were set.</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="Hook，Action-與-Filter"><a href="#Hook，Action-與-Filter" class="headerlink" title="Hook，Action 與 Filter"></a><strong>Hook，Action 與 Filter</strong></h2><p>Hook 說是 WordPress 最重要的機制也不為過，不管是 Theme 還是 Plugin 開發都會需要用到大量的 Hook。什麼是 Hook？簡單說就是先在程式碼裡面貼上一個無痕掛鉤，然後要修改 WordPress 只需把你寫的程式「掛」在這個預先貼好的無痕掛鉤上就可以執行了，外「掛」就是這樣運作的。</p>
<p>跟感冒藥一樣，Hook 也有兩種：Action 與 Filter。</p>
<p><strong>（ㄧ）Action</strong> - 設計新功能的掛鉤</p>
<p>貼上掛鉤的 Function 叫做 do_action( $tag, $arg )，它可以帶入兩個參數，第一個是掛鉤的名字，第二個是資料的參數，可以有很多個，主要作用是讓新功能掛在這邊的時候可以取得資料。</p>
<p>掛的動作叫做 add_action()，第一個參數是掛鉤名字，第二個是要執行新功能的 Function，下面的例子示範要如何在你的 Theme 或是 Plugin 裡面判斷使用者的登入狀態：</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token function">add_action</span><span class="token punctuation">(</span> <span class="token string single-quoted-string">'init'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'my_user_check'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">my_user_check</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token function">is_user_logged_in</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"已登入！"</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>在 WordPress 核心裡面有一個叫做 init 的掛鉤，它是被貼在當程式初始化的地方，所以只要當程式一載入，就會執行 my_user_check 這隻 Function，而這段程式碼可以放在 Theme 的 function.php 或是 Plugin 的主程式裡面，這樣要判斷會員登入狀態就不用去改 WordPress 核心程式碼。</p>
<blockquote>
<p>所有可以用的 Action 可參考 —&gt; <a target="_blank" rel="noopener" href="https://adambrown.info/p/wp_hooks/hook/actions"></a><a target="_blank" rel="noopener" href="https://adambrown.info/p/wp_hooks/hook/actions">https://adambrown.info/p/wp_hooks/hook/actions</a>，數量足足有七百多個，但常用的大概就那幾個：init、wp_head、wp_footer 等等，其他的就等到需要的時候再去查就好。</p>
</blockquote>
<p><strong>（二）Filter</strong> - 修改內建資料的掛鉤</p>
<p>跟 Actions 一樣的運作邏輯，但與 Actions 的差異可以從名稱上看出來，Filter 是過濾器的意思，也就是把原本會顯示的內容多裝一個過濾器，去修改資料的最後呈現，相關 Function 說明如下：</p>
<p><strong>apply_filters( $tag, $value) - 裝上過濾器</strong></p>
<p>第一個參數為過濾器的名字，第二個參數決定什麼資料要被過濾，可以有很多個，同樣的，在核心程式碼中一樣有<a target="_blank" rel="noopener" href="https://adambrown.info/p/wp_hooks/hook/filters">一大堆</a>已經寫好的 Filter 等著你來用。</p>
<p><strong>add_filter( $tag, $function, $priority, $accepted_args ) 使用過濾器</strong></p>
<p>第一個參數為要用哪個過濾器，第二個為要修改資料的 Function，第三個是執行順序，預設值是 10，數字越小越先執行，當有很多人同時在用過濾器的時候，就用這個數字來決定使用順序。</p>
<p>第四個參數是可接受的參數數量，預設值是 1，實際上會根據 apply_filters 的 $value 數量來決定這個數字，下面例子說明如何修改每一篇文章標題的格式：</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token function">add_filter</span><span class="token punctuation">(</span> <span class="token string single-quoted-string">'the_title'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'my_filtered_title'</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">2</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">my_filtered_title</span><span class="token punctuation">(</span> <span class="token variable">$value</span><span class="token punctuation">,</span> <span class="token variable">$id</span> <span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token variable">$value</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'['</span> <span class="token operator">.</span> <span class="token variable">$value</span> <span class="token operator">.</span> <span class="token string single-quoted-string">']'</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token variable">$value</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>add_filter 第一個是過濾器名字，第二個是要執行的 Function，在這範例中是把文章標題左右各加入中括號，my_filtererd_title 要給兩個參數，因為過濾器 the_title 長這樣：apply_filters( ‘the_title’, $title, $id )，然後執行順序是預設值 10，最後的 2 是指定過濾器的 $title 與 $id。</p>
<p>$id 這個參數在這範例中沒用到，它可以拿到文章的 ID，所以可以針對文章來進行標題的過濾，範例補充如下：</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token function">add_filter</span><span class="token punctuation">(</span> <span class="token string single-quoted-string">'the_title'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'my_filtered_title'</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">2</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">my_filtered_title</span><span class="token punctuation">(</span> <span class="token variable">$value</span><span class="token punctuation">,</span> <span class="token variable">$id</span> <span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span> <span class="token variable">$id</span> <span class="token operator">===</span> <span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token variable">$value</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'['</span> <span class="token operator">.</span> <span class="token variable">$value</span> <span class="token operator">.</span> <span class="token string single-quoted-string">']'</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token variable">$value</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>這樣就只會修改文章 ID 為 1 的標題帶有中括號。</p>
<p>在實務上為了程式碼的可讀性，要根據使用目的來選擇 Hook，如果是要修改資料的 return 結果，那就是用 Filter，如果是要在某個特定的時間點來執行你寫的功能，就使用 Action。</p>
<blockquote>
<p>何時要用 Action 還是 Filter 我有時候也搞不清楚，像是移除 WordPress 版本號的顯示是用 Filter，但要關閉後台首頁 Dashboard 預設 Widget 顯示的時候是用 Action。</p>
<p>後來我的理解方式是如果要執行某個具體的「動作」就是用 Action，要「修改」某些內容就是用 Filter，萬一還是搞不清楚就是爬原始碼看它這邊是埋 do_action 還是 apply_filters，久了就會慢慢記起來了。</p>
</blockquote>
<h2 id="本機與主機環境"><a href="#本機與主機環境" class="headerlink" title="本機與主機環境"></a><strong>本機與主機環境</strong></h2><p>WordPress 需要伺服器才能運作，通常在開發上會先使用本機的伺服器環境進行開發，完成後才會放到遠端的主機上讓人瀏覽，以下就本機與主機環境進行說明：</p>
<p><strong>（一）本機開發環境</strong></p>
<p>在開發階段使用本機環境來進行會比較有效率，除了可以離線作業以外，在進行新功能的測試時也不會影響到在正式運作的站，等確認無誤後，再透過 FTP 或是版本控管把程式碼上傳到遠端主機中。</p>
<p>網路上有很多適合 WordPress 在本機開發的軟體，像是 <a target="_blank" rel="noopener" href="https://www.mamp.info/en/mac/">MAMP</a> ( Mac / Apache / MySQL / PHP)、<a target="_blank" rel="noopener" href="http://www.wampserver.com/en/">WAMP</a> ( Windows / Apache / MySQL / PHP )，另外還有 <a target="_blank" rel="noopener" href="https://www.apachefriends.org/index.html">XAMPP</a>、<a target="_blank" rel="noopener" href="https://www.ampps.com/">AMPPS</a>，他們是跨平台的建置本機開發環境軟體。</p>
<p>此外還有很多是針對 WordPress 的，像是 <a target="_blank" rel="noopener" href="https://serverpress.com/">DesktopServer</a>、<a target="_blank" rel="noopener" href="https://localwp.com/">Local</a> 都是非常受歡迎的本機開發環境，這些都有圖形化介面提供使用者操作。</p>
<p>其他還有必須透過終端機指令安裝的軟體，像是 VirtualBox、Vagrant 與 Docker，這些工具適合拿來做自動化測試與部署，在 WordPress.org 有詳細的文件來說明 <a target="_blank" rel="noopener" href="https://make.wordpress.org/core/handbook/tutorials/installing-a-local-server/installing-vvv/">Installing Varying Vagrant Vagrants</a> (VVV)。</p>
<blockquote>
<p>要用哪套本機開發軟體主要看個人的使用習慣以及需求，像我是使用 Mac，最早用 MAMP，中間用過 VVV、Docker，後來改用 Local，但因為我的電腦比較舊、容量又小，這些軟體都會把每一個站開出獨立的伺服器環境，所以害我硬碟常常滿載，直到最近終於找到一套非常輕量的本機軟體，速度也很不錯，還可以把我在本機建立 WordPress 站的流程自動化，有興趣的朋友可以參考這篇—&gt;<a href="https://oberonlai.blog/valtpress-setup/">Mac 限定 WordPress 本機開發環境 Valet + ValetPress</a>。</p>
</blockquote>
<p>（二）網站主機</p>
<p>簡單來說，網站主機就是當訪客連到你的網站時所造訪的主機，網站的運作效能、安全性、承載能力很大一部分是取決於使用的主機商，世界上有爆炸多的網站主機服務商，而他們也都可以運作 WordPress，但並非全部的主機商都有針對 WordPress 來進行系統的優化。</p>
<p>代管式主機商 ( Managed WordPress Hosting ) 才會有提供優化過的主機環境，特別是針對大型的 WordPress 網站，會包含許多系統底層的快取機制，進而加快資料庫的存取，如果網站規模大硬體資源不足，很容易就會造成網站斷線的情況。</p>
<p>WordPress 有內建的快取機制來優化內容的呈現，如果主機商沒有幫你做快取的話，可以再搭配快取外掛來加快瀏覽速度，關於快取第十四章會有更深入的說明。</p>
<p>另外還有一些代管式的主機商會提供更多附加功能，像是自動更新外掛、內容傳遞服務 ( CDN ) 等等，這類的廠商有 WP Engine、WordPress VIP、Pagely 以及其他超多的選擇。</p>
<blockquote>
<p>我自己的習慣是租 VPS 然後<a target="_blank" rel="noopener" href="https://hellowp.cc/how-to-host-wordpress-with-plesk/">安裝主機管理面板 Plesk</a> 來管理 WordPress，一來比較便宜，二來擁有系統權限可以做的事情比較多，缺點是系統優化、快取那些東西要自己研究，以及網站掛掉的時候要想辦法處理，這樣可以學到很多，對於 WordPress 也會有更深層的認識。</p>
</blockquote>
<h2 id="開發、測試與正式環境"><a href="#開發、測試與正式環境" class="headerlink" title="開發、測試與正式環境"></a><strong>開發、測試與正式環境</strong></h2><p>通常在網站開發的過程中，會有三種不同階段的環境：開發環境 ( Development )、測試環境 ( Staging ) 與正式環境 ( Production )。理想上這三種環境會是在不同的主機上、有獨立的 WordPress 與資料庫。</p>
<p>開發環境又稱為 Dev 或是 DEV，通常是用來寫程式的本機環境；測試環境又稱為 Testing 或是 TEST，主要用來測試上機後的網站，網站的資料與正式環境盡量保持同步；正式環境又稱為 Live 或是 PRD，是你的訪客會造訪的環境。</p>
<p>如果你沒有辦法建立這三種環境，最起碼要有開發與測試兩種，然後絕對不要在正式環境直接進行修改與測試。最好的做法是所有開發都在本機完成，然後使用版本控管系統來把程式碼推到開發環境上，這樣當有多位工程師協同工作的時候就會有版本紀錄，以避免程式碼被覆蓋。</p>
<p>然後如果公司內部要進行測試時，先把正式環境的資料複製到測試環境，然後再把開發環境的程式碼部署到測試環境，等到都測試無誤後，再把程式碼部署到正式環境。</p>
<p>在部署到正式環境前記得要有備份，萬一網站爆炸時才能立即還原，千千萬萬不要以為寫好的程式碼不用測試就可以正常運作，一定都要經過測試才行。</p>
<p>有些代管式的主機商有提供測試環境，像是 WP Engine，他們會把每一個在上面的 WordPress 站都自動建立測試站，是非常方便的功能。</p>
<blockquote>
<p>新的專案我的實務做法是開發在本機，然後用 Github Private Repository 做版控，主機上面使用 Plesk 的 Git 套件，先開測試站與正式站，然後用 Plesk 設定當 Git Push 的時候會自動 Deploy 到測試站裡面，待測試無誤後，再使用 Plesk 的 WordPress Clone 功能把測試站完整複製到正式站去，Plesk 會自動把網址做替換。</p>
<p>網站上線後的修改，我會先用 Plesk 的同步功能，先把正式站的資料庫跟測試站同步，然後再把開發環境的修改 Deploy 到測試站進行測試。</p>
<p>萬一外掛有更新的話，我會統一先在測試站進行更新，確認無誤後再把檔案的部份 ( 不含資料庫 ) 同步到正式站，但有些外掛更新也會動到資料庫，所以檔案同步過去後還是要進正式站的後台去點選資料庫更新。</p>
<p>但我常常還是會偷懶，只有我一個人弄的小專案就還是開個 SFTP 然後搭配 VSCode 的 SFTP 套件，直接在存檔時自動上傳，或是用 <a target="_blank" rel="noopener" href="https://code.visualstudio.com/docs/remote/remote-overview">Remote Development</a> 直接 SSH 進主機修改，如果檔案有在本機 Git 一定會做一下，不然就是 Time Machine 備份硬碟隨時插著，以防萬一。</p>
</blockquote>
<p>第二章介紹了 WordPress 的基礎知識，包含如何建立環境、資料的存放方式，以及一些操作資料的 Function，另外還有最重要的 Hook。接下來進入 WordPress 最強大的部分：外掛 Plugin。</p>

    </div>

    
    
    

      <footer class="post-footer">
          
          <div class="post-tags">
              <a href="/tw/tags/Hook/" rel="tag"><i class="fa fa-tag"></i> Hook</a>
              <a href="/tw/tags/localhost/" rel="tag"><i class="fa fa-tag"></i> localhost</a>
              <a href="/tw/tags/schema/" rel="tag"><i class="fa fa-tag"></i> schema</a>
              <a href="/tw/tags/taxonomy/" rel="tag"><i class="fa fa-tag"></i> taxonomy</a>
              <a href="/tw/tags/wp-comment/" rel="tag"><i class="fa fa-tag"></i> wp_comment</a>
              <a href="/tw/tags/wp-option/" rel="tag"><i class="fa fa-tag"></i> wp_option</a>
              <a href="/tw/tags/wp-posts/" rel="tag"><i class="fa fa-tag"></i> wp_posts</a>
              <a href="/tw/tags/wp-terms/" rel="tag"><i class="fa fa-tag"></i> wp_terms</a>
              <a href="/tw/tags/wp-users/" rel="tag"><i class="fa fa-tag"></i> wp_users</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/tw/ods-starter-theme/" rel="prev" title="【 工具 】使用 ODS starter theme 開發 WordPress 佈景主題">
      <i class="fa fa-chevron-left"></i> 【 工具 】使用 ODS starter theme 開發 WordPress 佈景主題
    </a></div>
      <div class="post-nav-item">
    <a href="/tw/building-web-apps-with-wordpress-plugin/" rel="next" title="【 書摘 】Building Web Apps with WordPress - 使用 WordPress 外掛">
      【 書摘 】Building Web Apps with WordPress - 使用 WordPress 外掛 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          
    
  <div class="comments">
    <div id="disqus_thread">
      <noscript>Please enable JavaScript to view the comments powered by Disqus.</noscript>
    </div>
  </div>
  

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目錄
        </li>
        <li class="sidebar-nav-overview">
          本站概要
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BA%8C%E3%80%81WordPress-Basic-WordPress-%E5%9F%BA%E6%9C%AC%E4%BB%8B%E7%B4%B9"><span class="nav-number">1.</span> <span class="nav-text">二、WordPress Basic &#x2F; WordPress 基本介紹</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#WordPress-%E8%B3%87%E6%96%99%E5%A4%BE%E7%B5%90%E6%A7%8B"><span class="nav-number">2.</span> <span class="nav-text">WordPress 資料夾結構</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#WordPress-%E8%B3%87%E6%96%99%E5%BA%AB%E7%B5%90%E6%A7%8B"><span class="nav-number">3.</span> <span class="nav-text">WordPress 資料庫結構</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Hook%EF%BC%8CAction-%E8%88%87-Filter"><span class="nav-number">4.</span> <span class="nav-text">Hook，Action 與 Filter</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9C%AC%E6%A9%9F%E8%88%87%E4%B8%BB%E6%A9%9F%E7%92%B0%E5%A2%83"><span class="nav-number">5.</span> <span class="nav-text">本機與主機環境</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%96%8B%E7%99%BC%E3%80%81%E6%B8%AC%E8%A9%A6%E8%88%87%E6%AD%A3%E5%BC%8F%E7%92%B0%E5%A2%83"><span class="nav-number">6.</span> <span class="nav-text">開發、測試與正式環境</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="賴俊吾 / Oberon Lai"
      src="/tw/images/avatar.jpg">
  <p class="site-author-name" itemprop="name">賴俊吾 / Oberon Lai</p>
  <div class="site-description" itemprop="description">現為全職 WordPress 工程師，網站開發經歷 11 年，專攻前端工程與 WordPress 佈景主題、外掛客製化開發</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/tw/archives">
          <span class="site-state-item-count">261</span>
          <span class="site-state-item-name">文章</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/tw/categories/">
        <span class="site-state-item-count">38</span>
        <span class="site-state-item-name">分類</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tw/tags/">
        <span class="site-state-item-count">80</span>
        <span class="site-state-item-name">標籤</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/oberonlai" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;oberonlai" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:m615926@gmail.com" title="E-Mail → mailto:m615926@gmail.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://twitter.com/oberonlai" title="Twitter → https:&#x2F;&#x2F;twitter.com&#x2F;oberonlai" rel="noopener" target="_blank"><i class="fab fa-twitter fa-fw"></i>Twitter</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://www.facebook.com/m615926" title="FB Page → https:&#x2F;&#x2F;www.facebook.com&#x2F;m615926" rel="noopener" target="_blank"><i class="fab fa-facebook fa-fw"></i>FB Page</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">賴俊吾 / Oberon Lai</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
    <span title="總字數">605k</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="所需總閱讀時間">9:10</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://mist.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Mist</a> 強力驅動
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/tw/lib/anime.min.js"></script>
  <script src="/tw/lib/pjax/pjax.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/medium-zoom@1/dist/medium-zoom.min.js"></script>

<script src="/tw/js/utils.js"></script>


<script src="/tw/js/schemes/muse.js"></script>


<script src="/tw/js/next-boot.js"></script>

  <script>
var pjax = new Pjax({
  selectors: [
    'head title',
    '#page-configurations',
    '.content-wrap',
    '.post-toc-wrap',
    '.languages',
    '#pjax'
  ],
  switches: {
    '.post-toc-wrap': Pjax.switches.innerHTML
  },
  analytics: false,
  cacheBust: false,
  scrollTo : !CONFIG.bookmark.enable
});

window.addEventListener('pjax:success', () => {
  document.querySelectorAll('script[data-pjax], script#page-configurations, #pjax script').forEach(element => {
    var code = element.text || element.textContent || element.innerHTML || '';
    var parent = element.parentNode;
    parent.removeChild(element);
    var script = document.createElement('script');
    if (element.id) {
      script.id = element.id;
    }
    if (element.className) {
      script.className = element.className;
    }
    if (element.type) {
      script.type = element.type;
    }
    if (element.src) {
      script.src = element.src;
      // Force synchronous loading of peripheral JS.
      script.async = false;
    }
    if (element.dataset.pjax !== undefined) {
      script.dataset.pjax = '';
    }
    if (code !== '') {
      script.appendChild(document.createTextNode(code));
    }
    parent.appendChild(script);
  });
  NexT.boot.refresh();
  // Define Motion Sequence & Bootstrap Motion.
  if (CONFIG.motion.enable) {
    NexT.motion.integrator
      .init()
      .add(NexT.motion.middleWares.subMenu)
      .add(NexT.motion.middleWares.postList)
      .bootstrap();
  }
  NexT.utils.updateSidebarPosition();
});
</script>




  




  
<script src="/tw/js/local-search.js"></script>













    <div id="pjax">
  

  

<script>
  function loadCount() {
    var d = document, s = d.createElement('script');
    s.src = 'https://oberon-lai.disqus.com/count.js';
    s.id = 'dsq-count-scr';
    (d.head || d.body).appendChild(s);
  }
  // defer loading until the whole page loading is completed
  window.addEventListener('load', loadCount, false);
</script>
<script>
  var disqus_config = function() {
    this.page.url = "https://oberonlai.blog/tw/building-web-apps-with-wordpress-basic/";
    this.page.identifier = "building-web-apps-with-wordpress-basic/";
    this.page.title = "【 書摘 】Building Web Apps with WordPress - WordPress 基本介紹";
    };
  NexT.utils.loadComments(document.querySelector('#disqus_thread'), () => {
    if (window.DISQUS) {
      DISQUS.reset({
        reload: true,
        config: disqus_config
      });
    } else {
      var d = document, s = d.createElement('script');
      s.src = 'https://oberon-lai.disqus.com/embed.js';
      s.setAttribute('data-timestamp', '' + +new Date());
      (d.head || d.body).appendChild(s);
    }
  });
</script>

    </div>
</body>
</html>
