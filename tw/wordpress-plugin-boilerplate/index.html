<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/tw/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/tw/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/tw/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/tw/images/logo.svg" color="#222">
  <meta http-equiv="Cache-Control" content="no-transform">
  <meta http-equiv="Cache-Control" content="no-siteapp">

<link rel="stylesheet" href="/tw/css/main.css">


<link rel="stylesheet" href="/tw/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"oberonlai.blog","root":"/tw/","scheme":"Mist","version":"7.8.0","exturl":false,"sidebar":{"position":"right","display":"post","padding":18,"offset":12,"onmobile":true},"copycode":{"enable":true,"show_result":true,"style":"mac"},"back2top":{"enable":true,"sidebar":false,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":true,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":"disqus","storage":true,"lazyload":false,"nav":{"disqus":{"text":"Load Disqus","order":-1}},"activeClass":"disqus"},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":false,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideDownIn","sidebar":"slideDownIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="一年前的這個時候，從早到晚都在跟 WordPress 的佈景主題打交道，除了忙案子以外，空檔時就在研究哪些前端框架可以更快速的與 WordPress 做整合，想不到十二個月過去了，現在每天都改成在寫外掛，離前端程式開發越來越遠，停下腳步回頭來看，感覺是該來好好整理一下這陣子的開發心得了。 為了方便閱讀我拆成以下幾個章節來紀錄： 一、WordPress 外掛架構 - 紀錄曾經使用過的架構以及目前作法">
<meta property="og:type" content="article">
<meta property="og:title" content="【 心得 】WordPress 外掛開發日記 (一) - 架構">
<meta property="og:url" content="https://oberonlai.blog/tw/wordpress-plugin-boilerplate/">
<meta property="og:site_name" content="WordPress 開發日常">
<meta property="og:description" content="一年前的這個時候，從早到晚都在跟 WordPress 的佈景主題打交道，除了忙案子以外，空檔時就在研究哪些前端框架可以更快速的與 WordPress 做整合，想不到十二個月過去了，現在每天都改成在寫外掛，離前端程式開發越來越遠，停下腳步回頭來看，感覺是該來好好整理一下這陣子的開發心得了。 為了方便閱讀我拆成以下幾個章節來紀錄： 一、WordPress 外掛架構 - 紀錄曾經使用過的架構以及目前作法">
<meta property="og:locale" content="zh_TW">
<meta property="og:image" content="https://oberonlai.blog/wp-content/uploads/wordpress-plugin-boilerplate/wordpress-plugin-boilerplate-03.jpg">
<meta property="og:image" content="https://oberonlai.blog/wp-content/uploads/wordpress-plugin-boilerplate/wordpress-plugin-boilerplate-04.jpg">
<meta property="og:image" content="https://oberonlai.blog/wp-content/uploads/wordpress-plugin-boilerplate/wordpress-plugin-boilerplate-01.jpg">
<meta property="og:image" content="https://oberonlai.blog/wp-content/uploads/wordpress-plugin-boilerplate/wordpress-plugin-boilerplate-02.jpg">
<meta property="og:image" content="https://oberonlai.blog/wp-content/uploads/wordpress-plugin-boilerplate/wordpress-plugin-boilerplate-05.jpg">
<meta property="article:published_time" content="2021-06-15T10:00:00.000Z">
<meta property="article:modified_time" content="2021-07-26T04:55:03.595Z">
<meta property="article:author" content="賴俊吾 &#x2F; Oberon Lai">
<meta property="article:tag" content="boilerplate">
<meta property="article:tag" content="composer">
<meta property="article:tag" content="phpcs">
<meta property="article:tag" content="git">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://oberonlai.blog/wp-content/uploads/wordpress-plugin-boilerplate/wordpress-plugin-boilerplate-03.jpg">

<link rel="canonical" href="https://oberonlai.blog/tw/wordpress-plugin-boilerplate/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-TW'
  };
</script>

  <title>【 心得 】WordPress 外掛開發日記 (一) - 架構 | WordPress 開發日常</title>
  
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-163107142-1"></script>
    <script data-pjax>
      if (CONFIG.hostname === location.hostname) {
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'UA-163107142-1');
      }
    </script>






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切換導航欄">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta custom-logo">

    <a href="/tw/" class="brand" rel="start" style="display: block">
        <img class="logo-img" src="/tw/images/logo-w.svg" alt="WordPress 開發日常">
    </a>
      <p class="site-subtitle" itemprop="description">有任何 WordPress 客製需求歡迎與我聯絡！</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-關於我">

    <a href="/tw/about/" rel="section">關於我</a>

  </li>
        <li class="menu-item menu-item-合作方式">

    <a href="/tw/how-can-oberon-help-you/" rel="section">合作方式</a>

  </li>
        <li class="menu-item menu-item-計價方式">

    <a href="/tw/how-do-i-make-a-quotation/" rel="section">計價方式</a>

  </li>
        <li class="menu-item menu-item-學習-wordpress">

    <a href="/tw/wordpress-full-stack/" rel="section">學習 WordPress</a>

  </li>
        <li class="menu-item menu-item-與我聯繫">

    <a href="mailto:m615926@gmail.com" rel="noopener" target="_blank">與我聯繫</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger">搜尋
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜尋..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>

  <a href="https://github.com/oberonlai" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-TW">
    <link itemprop="mainEntityOfPage" href="https://oberonlai.blog/tw/wordpress-plugin-boilerplate/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/tw/images/avatar.jpg">
      <meta itemprop="name" content="賴俊吾 / Oberon Lai">
      <meta itemprop="description" content="現為全職 WordPress 工程師，網站開發經歷 11 年，專攻前端工程與 WordPress 佈景主題、外掛客製化開發">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="WordPress 開發日常">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          【 心得 】WordPress 外掛開發日記 (一) - 架構
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">發表於</span>

              <time title="創建時間：2021-06-15 18:00:00" itemprop="dateCreated datePublished" datetime="2021-06-15T18:00:00+08:00">2021-06-15</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新於</span>
                <time title="修改時間：2021-07-26 12:55:03" itemprop="dateModified" datetime="2021-07-26T12:55:03+08:00">2021-07-26</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分類於</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/tw/categories/%E5%A4%96%E6%8E%9B%E9%96%8B%E7%99%BC/" itemprop="url" rel="index"><span itemprop="name">外掛開發</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
    
    <a title="disqus" href="/tw/wordpress-plugin-boilerplate/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="wordpress-plugin-boilerplate/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
            <span class="post-meta-item" title="文章字數">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
              <span>11k</span>
            </span>
            <span class="post-meta-item" title="所需閱讀時間">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
              <span>10 分鐘</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p>一年前的這個時候，從早到晚都在跟 WordPress 的佈景主題打交道，除了忙案子以外，空檔時就在研究哪些前端框架可以更快速的與 WordPress 做整合，想不到十二個月過去了，現在每天都改成在寫外掛，離前端程式開發越來越遠，停下腳步回頭來看，感覺是該來好好整理一下這陣子的開發心得了。</p>
<p>為了方便閱讀我拆成以下幾個章節來紀錄：</p>
<p><a href="https://oberonlai.blog/tw/wordpress-plugin-boilerplate">一、WordPress 外掛架構 - 紀錄曾經使用過的架構以及目前作法</a><br><a href="https://oberonlai.blog/tw/wordpress-and-composer">二、WordPress 開發實用 Composer 套件 - 介紹在寫外掛的時候可以加速開發的套件</a><br>三、載入佈景主題範本 - 如何在外掛裡面使用範本檔修改前端介面並整合前端開發流程<br>四、整合 PHPUnit 單元測試 - 避免改東牆壞西牆的問題再次發生<br>五、自動化部署 - 讓 WordPress 搭上 DevOps 的列車🚄<br>六、WordPress 外掛更新 - 自行管理未上架 wordpress.org 的外掛版本維護</p>
<p>如果是對 WordPress 外掛開發完全沒概念的朋友，我建議先閱讀 <a target="_blank" rel="noopener" href="https://developer.wordpress.org/plugins/">Plugin Developer Handbook</a> 會比較完整，或是買<a href="https://oberonlai.blog/tw/building-web-apps-with-wordpress/">這本書</a>來看在學習上會比較有脈絡與系統性。而這系列文是我的實務經驗，所以很多地方可能還是會有不足之處，希望能遇到大大再幫我指點迷津了 🙏</p>
<p>第一篇文章主要紀錄了我在組織外掛結構的過程，並透過不斷的打掉重練來找到自己最舒服的方式，讓我們開始吧～</p>
<span id="more"></span>

<p>雖然不知道出來混為何一定要還，但還是手癢開始把這一年多來改寫外掛的日常紀錄一下XD，從開始入坑 Composer 到學著寫下第一行單元測試，再到外掛的自管更新以及自動化部署，寫到一半發現餅華太大，只好拆成多篇來寫 &gt; &lt; 第一篇介紹目前我慣用的 Starter Plugin ( 好像沒這種說法XD ) 與工作流程，以及隨著時間演進的組織方法，所以萬一明天點開來看發現跟今天看到的內容不一樣還請見諒，文章也是需要重構的XD 文中如有不足之處還煩請大大指點迷津了 🙏</p>
<h2 id="WordPress-外掛架構"><a href="#WordPress-外掛架構" class="headerlink" title="WordPress 外掛架構"></a>WordPress 外掛架構</h2><p>以佈景主題來說，有很多公司推出初始佈景主題 ( Starter Theme ) 可以入門，相較之下外掛就少很多，原因可能是外掛的組織方式太自由了，基本上我可以把所有的程式碼全都塞進到帶有標頭的 PHP 檔案即可，不需要拆分任何檔案與資料夾，但如果是做功能複雜或是大型外掛的擴充，這樣做會被未來的自己罵到臭頭XD</p>
<p>剛開始實作的時候我是採用「 <a target="_blank" rel="noopener" href="https://wppb.me/">WordPress Plugin Boilerplate Generator</a>」，不管要做的功能是大還是小，我覺得遵循這套架構可以讓檔案很有邏輯與系統，它的特色是在於把前後台的資料夾切分開來，然後透過一層又一層的類別來做載入。</p>
<pre class="line-numbers language-none"><code class="language-none">── LICENSE.txt
├── README.txt
├── admin
│   ├── class-my-plugin-admin.php
│   ├── css
│   │   └── my-plugin-admin.css
│   ├── index.php
│   ├── js
│   │   └── my-plugin-admin.js
│   └── partials
│       └── my-plugin-admin-display.php
├── includes
│   ├── class-my-plugin-activator.php
│   ├── class-my-plugin-deactivator.php
│   ├── class-my-plugin-i18n.php
│   ├── class-my-plugin-loader.php
│   ├── class-my-plugin.php
│   └── index.php
├── index.php
├── languages
│   └── my-plugin.pot
├── my-plugin.php
├── public
│   ├── class-my-plugin-public.php
│   ├── css
│   │   └── my-plugin-public.css
│   ├── index.php
│   ├── js
│   │   └── my-plugin-public.js
│   └── partials
│       └── my-plugin-public-display.php
└── uninstall.php<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>但經過幾個專案後發現不太順手，問題在於它把勾點 ( Hook ) 跟要跑在勾點上的函式切開來，常常在找這支函式是跑在哪個勾點上時會花上一些時間，更不用說在寫勾點的時候還需要切換檔案很容易混亂。</p>
<p>其次是很多功能很難界定它到底是屬於前台還後台，像是在做 REST API 我有時候會放在 public，有時候忘記又會放在 admin，要找的時候自己都會搞混。</p>
<p>然後最麻煩的地方是檔案的載入，WPPB 是使用 require 的方式來引入，所以如果新增檔案或是修改檔名的時候都會需要手動修改，最常發生的情況就是類別寫完後一直跑不動，追查後才發現根本忘記引入了 😅</p>
<p>所以一直在找尋著有沒有更好的架構可以來開發外掛，找了老半天都沒有適合自己的，索性就來發展一套自己的邏輯吧～</p>
<p>剛好當時在看「<a target="_blank" rel="noopener" href="https://www.books.com.tw/products/0010688181">現代 PHP</a> 」這本書，對於 Composer 很有興趣，就開始試著把 Composer 整合進 WordPress 的開發流程之中。</p>
<p>Composer 可以簡單的理解為是一套可以安裝 PHP 外掛的工具，可以把別人寫好的 PHP 類別透過 Composer 安裝後進行使用。</p>
<p>除此之外，它還可以幫助開發者做自動載入、套件更新管理，甚至還可以安裝 WP 的外掛，透過它來管理 WP 網站的外掛，你也可以上傳自己寫的套件，把一些常用的類別打包好後上傳，下次要用時直接透過 Composer 進行安裝。</p>
<p>更多 Composer 的實作細節會隨著下文逐一帶到，回到 WordPress 外掛開發架構的需求，我想要的是可以依照專案規模自行增加資料夾結構以及檔案命名，尤其是外掛開發的初期功能還很陽春，可能幾個檔案就搞定，等到外掛發展的越來越大，我可以隨時調整檔案結構以符合商業邏輯的變動。</p>
<p>參考了很多免費與付費外掛的結構後，目前已發展出一套自己的 SOP，大概的順序如下</p>
<h3 id="1-建立基本架構"><a href="#1-建立基本架構" class="headerlink" title="1.建立基本架構"></a>1.建立基本架構</h3><p>建立外掛的第一步就是在 wp-content/plugins 底下建立資料夾，然後新增主檔案與 src (source) 資料夾放主程式，這樣就完成最基本的結構了。</p>
<pre class="line-numbers language-none"><code class="language-none">my-plugin
├── my-plugin.php
└── src<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>如果專案有前端的部分需要處理，我會開 assets 資料夾，裡面會放圖檔、CSS 與 JavaScript 等靜態檔案：</p>
<pre class="line-numbers language-none"><code class="language-none">my-plugin
└── assets
    ├── css
    │   ├── admin.css
    │   └── public.css
    ├── img
    │   └── img1.jpg
    └── js
        ├── admin.js
        ├── ajax.js
        └── public.js<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>前後台的靜態檔就用檔名來區分，前台就是 public 後台是 admin，如果有需要做 Ajax 的 JS 檔也是會放在這邊。如果要進一步的整合 Node.js 來做前端的檔案編譯，assets 下面會再區分 src 跟 dist，然後才放 img、css 與 js 資料夾，之前有實作過整合最近非常紅的 CSS 框架 Tailwindcss，這部分會在之後的文章提到。</p>
<p>再來如果這個外掛有需要處理範本的話，我會再另外開一個 views 資料夾，這資料夾就像是佈景主題一樣，專門放範本檔：</p>
<pre class="line-numbers language-none"><code class="language-none">my-plugin
└── views
    ├── loops
    │   └── post.php
    ├── page-about.php
    ├── page-contact.php
    ├── partials
    │   └── pagination.php
	├── woocommerce
    │   └── checkout
    ├── template-2col.php
    └── template-blank.php<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>views 除了放對應 slug 的範本檔之外，也放了頁面範本，loops 資料夾放的是需要跑在 WP_Query 裡面的列表類內容，而 partials 放的是所有頁面會共用到的元件，像是分頁導覽 pagination。如果是做 WooCommerce 的 Extension 我會再多開一個資料放 WC 的範本檔，這樣就能從外掛來修改 WC 相關頁面的內容。</p>
<p>再來是 src 裡面的結構，嘗試了很多命名方法，最喜歡的應該是 MVC 模式：</p>
<pre class="line-numbers language-none"><code class="language-none">my-plugin
└── src
    ├── controllers
    │   └── cpt.php
    └── models
        └── cpt.php<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>View 的部分我把它獨立在 src 的資料夾外面，原因是 src 的資料夾會透過 PSR-4 的 Autoload 載入，但 WP 的範本檔並不支援這樣的機制，所以把 views 獨立在 src 以外避免被自動載入。</p>
<p>Models 資料夾我放的是需要新增或修改資料庫結構的類別，最常見的就是新增 Custom Post Type，或是需要修改預設的文章或頁面 post type、新增 options、widget，我都會放在 Models 資料夾下面。</p>
<p>Controllers 則是負責處理 Models 裡面各種 post type 或是 option 的 CRUD，以及各種 WP 內建機制的處理，像是 REST API、WP Cron、Shortcode 等等，基本上這個資料夾會放所有的邏輯處理類別，需要呼叫類別的程式也是放在這邊。</p>
<p>如果有多個 CPT 需要處理多種操作，我會再新增新的資料夾來做區分：</p>
<pre class="line-numbers language-none"><code class="language-none">my-plugin
└── src
    ├── controllers
    │   ├── cpt.php
    │   ├── cpt1
    │   │   ├── Api.php
    │   │   ├── Router.php
    │   │   ├── Post.php	
    │   │   └── Shortcode.php
    │   └── cpt2
    │       ├── Post.php
    │       └── Widget.php
    └── models
        └── cpt.php<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>雖然從 MVC 的角度下去分類看似很清楚，但實作後常發現自己會混淆 M 跟 C 的部分，我曾經在一個專案中把 Shortcode 放在 Controllers，另一個專案卻放在 Models 裡面，或是要註冊 Rest API 我就常會舉棋不定，這到底該放在哪裡好？</p>
<p>於是索性就不分 Models 跟 Controllers 了，直接以 WordPress 資料表結構來區分資料夾：</p>
<pre class="line-numbers language-none"><code class="language-none">my-plugin
└── src
    ├── posts
    │   ├── cpt1
    │   │   ├── Ajax.php
    │   │   ├── Field.php
    │   │   └── Cpt1.php
    │   └── cpt2
    │       ├── Api.php
    │       ├── Cpt2.php
    │       └── Shortcode.php
    ├── terms
    │   ├── taxonomy1
    │   │   └── Field.php
    │   └── taxonomy2
    │       └── Api.php
    ├── options
    │   ├── Field.php
    │   └── Menu.php
    └── user
        └── Field.php<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>最常處理的是 wp_posts，所以 posts 資料夾下面會放各個 CPT 的資料夾，options 是做設定頁面的，對應的資料表是 wp_options，user 是使用者相關，對應的資料表是 wp_users，至於 Taxonomy 我也會跟 Post 拆開獨立放在 terms 的資料夾底下，在結構上會更清楚些。</p>
<p>然後每個 cpt 的資料夾底下，會有一支跟 CPT slug 同名的檔案，裡面放的會是註冊 CPT 的功能，下一篇文章會示範如何使用 Composer 套件來註冊 CPT，其他的 Field.php 、Ajax.php、Api.php 就是管理該 CPT 的相對應功能。</p>
<p>所以整個資料夾的邏輯就是以資料類型 &gt; 功能來區分，對我來說可以再也不用判斷這功能到底是屬於 Models 還是 Controllers。</p>
<p>最後則是單元測試的資料夾：</p>
<pre class="line-numbers language-none"><code class="language-none">my-plugin
└── tests
    └── cpt
        └── cptTest.php<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>測試的部分比較複雜，之後會再以獨立篇幅來進行說明。</p>
<p>另外如果是要做 i18n 本地化，就需要再新增一個 languages 資料夾，翻譯用的 .pot 檔可以透過 WP CLI 產生。</p>
<pre class="line-numbers language-none"><code class="language-none">$ wp i18n make-pot . languages&#x2F;my-plugin.pot<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>資料夾結構會是這樣：</p>
<pre class="line-numbers language-none"><code class="language-none">my-plugin
└── languages
    └── my-plugin.pot<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>最後視專案的需求，資料夾結構可以是這樣：</p>
<pre class="line-numbers language-none"><code class="language-none">my-plugin
├── my-plugin.php
└── src
    └── cpt1
        └── Cpt1.php<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>也可以逐漸發展成這樣：</p>
<pre class="line-numbers language-none"><code class="language-none">my-plugin
├── assets
│   ├── css
│   │   ├── admin.css
│   │   └── public.css
│   ├── img
│   │   └── img1.jpg
│   └── js
│       ├── admin.js
│       ├── ajax.js
│       └── public.js
├── my-plugin.php
├── src
│   ├── posts
│   │   ├── cpt1
│   │   │   ├── Ajax.php
│   │   │   ├── Field.php
│   │   │   └── Cpt1.php
│   │   └── cpt2
│   │       ├── Api.php
│   │       ├── Cpt2.php
│   │       └── Shortcode.php
│   ├── terms
│   │   ├── taxonomy1
│   │   │   └── Field.php
│   │   └── taxonomy2
│   │       └── Api.php
│   ├── options
│   │   ├── Field.php
│   │   └── Menu.php
│   └── user
│       └── Field.php
├── tests
│   └── cpt
│       └── cptTest.php
└── views
    ├── loops
    │   └── post.php
    ├── page-about.php
    ├── page-contact.php
    ├── partials
    │   └── pagination.php
    ├── template-2col.php
    ├── template-blank.php
    └── woocommerce<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>在實務中我最常變動的部分是 src 資料夾，除了需求的新增外，做程式碼重構也都會常常修改這邊，以往只要資料夾名稱或是檔案有新增刪除，透過手動引入的方式就必須要全部修改，有沒有更方便且更彈性的作法呢？有！答案就是 Composer。</p>
<h3 id="2-設定-Composer-環境"><a href="#2-設定-Composer-環境" class="headerlink" title="2.設定 Composer 環境"></a>2.設定 Composer 環境</h3><p>安裝 Composer 的教學網路非常多，這邊主要示範給 WordPress 外掛開發者的環境設定。第一步先開啟終端機然後把目錄切到正在開發的外掛底下：</p>
<pre class="line-numbers language-none"><code class="language-none">$ cd wp-content\plugins\my-plugin<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>然後執行 composer init</p>
<pre class="line-numbers language-none"><code class="language-none">$ composer init<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>composer 會用對話式的介面來協助我們進行設定，依序要回答六個問題：</p>
<pre class="line-numbers language-none"><code class="language-none">This command will guide you through creating your composer.json config.

Package name (&lt;vendor&gt;&#x2F;&lt;name&gt;) [oberonlai&#x2F;my-plugin]: 
Description []: 
Author [Oberon Lai &lt;m615926@gmail.com&gt;, n to skip]: 
Minimum Stability []: stable
Package Type (e.g. library, project, metapackage, composer-plugin) []: project
License []: propreitary<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>基本上因為這不是要上傳到 Composer 套件庫 Packagist 的套件，我習慣都直接採用預設值，如果有特殊需求可以再個別調整，第七題是關鍵，它會問你是否要安裝相依套件：</p>
<pre class="line-numbers language-none"><code class="language-none">Define your dependencies.

Would you like to define your dependencies (require) interactively [yes]? 
Search for a package: a7&#x2F;autoload
Enter the version constraint to require (or leave blank to use the latest version): <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>輸入套件名稱 a7/autoload 按下 Enter 後 Composer 就會開始自動搜尋 Packagist 上面的所有 PHP 套件並且指定安裝的版本，如果要安裝最新版就直接 Enter 下一步即可，<a target="_blank" rel="noopener" href="https://github.com/a7/autoload">a7/autoload</a> 這個套件可以把指定資料夾裡面的檔案全部自動載入，如果沒有它就需要一個一個手動指定要自動載入的資料夾。</p>
<p>完成後接下來又會再問一次是否要搜尋其他套件，這邊我們什麼都不輸入直接下 Enter 即可。</p>
<p>接下來它會詢問是否要安裝只有在開發時才需要的套件，像是做單元測試 PHPUnit 這一類只會在開發環境中需要的套件就可以在這邊安裝，但目前我們先跳過，之後講解單元測試的文章再另行說明：</p>
<pre class="line-numbers language-none"><code class="language-none">Would you like to define your dev dependencies (require-dev) interactively [yes]? no<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>接下來就會看到整個 Composer 設定檔的草稿，它會請你確認是否正確，輸入 Enter 即可，這樣就完成 composer.json 設定檔了。</p>
<pre class="line-numbers language-none"><code class="language-none">&#123;
    &quot;name&quot;: &quot;oberonlai&#x2F;my-plugin&quot;,
    &quot;type&quot;: &quot;project&quot;,
    &quot;require&quot;: &#123;
        &quot;a7&#x2F;autoload&quot;: &quot;^2.1&quot;
    &#125;,
    &quot;license&quot;: &quot;propreitary&quot;,
    &quot;authors&quot;: [
        &#123;
            &quot;name&quot;: &quot;Oberon Lai&quot;,
            &quot;email&quot;: &quot;m615926@gmail.com&quot;
        &#125;
    ],
    &quot;minimum-stability&quot;: &quot;stable&quot;
&#125;

Do you confirm generation [yes]? yes<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>最後它會問你是否要安裝設定檔中的套件，按下 Enter 即可</p>
<pre class="line-numbers language-none"><code class="language-none">Would you like to install dependencies now [yes]? yes<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>最後就會出現安裝完成的訊息，這就代表我們已經把 Composer 已經所需套件準備完成：</p>
<pre class="line-numbers language-none"><code class="language-none">No lock file found. Updating dependencies instead of installing from lock file. Use composer update over composer install if you do not have a lock file.
Loading composer repositories with package information
Updating dependencies
Lock file operations: 1 install, 0 updates, 0 removals
  - Locking a7&#x2F;autoload (2.1)
Writing lock file
Installing dependencies from lock file (including require-dev)
Package operations: 1 install, 0 updates, 0 removals
  - Installing a7&#x2F;autoload (2.1): Extracting archive
Generating autoload files<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>觀察我們外掛的目錄，會發現多了 composer.json、composer.lock 以及 vendor 資料夾，未來我們任何從 Composer 安裝的套件都會放在 vendor 這個資料夾底下，至於該如何引入這些套件以及讓 src 資料夾的檔案可以自動載入呢？讓我們開始寫 code 吧～</p>
<h3 id="3-加入-Autoload-機制"><a href="#3-加入-Autoload-機制" class="headerlink" title="3.加入 Autoload 機制"></a>3.加入 Autoload 機制</h3><p>打開外掛的主檔案，我把一些常用的寫法存成了 VSCode 的 Snippet，內容如下：</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

 <span class="token comment">/**
 * @link              https://oberonlai.blog
 * @since             1.0.0
 * @package           ODS
 *
 * @wordpress-plugin
 * Plugin Name:       Oberon Plugin
 * Plugin URI:        https://oberonlai.blog
 * Description:       Oberon Lai Blog Demo Plugins
 * Version:           1.0.0
 * Author:            Oberon Lai
 * Author URI:        https://oberonlai.blog
 * License:           GPL-2.0+
 * License URI:       http://www.gnu.org/licenses/gpl-2.0.txt
 * Text Domain:       ods
 * Domain Path:       /languages
 */</span>


<span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token operator">!</span> <span class="token function">defined</span><span class="token punctuation">(</span> <span class="token string single-quoted-string">'ABSPATH'</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">exit</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token function">define</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'ODS_VERSION'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'1.0.0'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">define</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'ODS_PLUGIN_URL'</span><span class="token punctuation">,</span> <span class="token function">plugin_dir_url</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">define</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'ODS_PLUGIN_DIR'</span><span class="token punctuation">,</span> <span class="token function">plugin_dir_path</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">define</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'ODS_PLUGIN_BASENAME'</span><span class="token punctuation">,</span> <span class="token function">plugin_basename</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">/**
 * Autoload
 */</span>
<span class="token keyword">require_once</span><span class="token punctuation">(</span> <span class="token constant">ODS_PLUGIN_DIR</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'vendor/autoload.php'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
\<span class="token constant">A7</span>\<span class="token function">autoload</span><span class="token punctuation">(</span> <span class="token constant">ODS_PLUGIN_DIR</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'src'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>外掛 Header 頭幾行的註解是必要的，具體內容可以參考 Handbook，define 的常數定義我會先把幾個常用的路徑存起來，因為 plugin_dir_xxx 在不同層級的檔案下會對應到不同的路徑，直接在主檔案存起來才能正確對應到外掛的根目錄。</p>
<p>再往下看就是最關鍵的 Autoload，第一個 require_once 載入的是 vendor/autoload.php，也就是透過 Composer 安裝的套件只需要這一行就可以全部自動引入，使用時只需要透過 Namespace 的 use 關鍵字即可使用，</p>
<p>而下一行的 \A7\autoload 則是指定自動載入 src 目錄底下所有的檔案，不管有幾層目錄、多少檔案，透過它就可以自動完整載入，縱使修改了檔名或是資料夾名稱，依舊都能正常運作。</p>
<p>a7\autoload 是由 Aaron Holbrook 所開發的，觀察他的程式碼，他使用了迴圈去掃描指定目錄的所有檔案，然後再透過 autoload 機制去逐一載入，雖然該套件已經有兩年多沒更新了，但用到目前為止都非常的穩定沒出過任何問題，因此它成為我每個專案的必備套件。</p>
<p>到這邊自動載入就完成了，日後如果我新增或修改任何 src 資料夾裡面的任何檔案名稱，就再也不用重新調整載入的路徑了，一勞永逸 🎉</p>
<h3 id="4-Git-設定"><a href="#4-Git-設定" class="headerlink" title="4. Git 設定"></a>4. Git 設定</h3><p>為了要能做到版本控管與自動部署，Git 版控也是我每個必用的工具，早期看到朋友的作法是直接把整個 wp-content 資料夾都納入版控，好處是所有外掛的更新都可以從 git 來管理，於是我也採用這樣的作法，但經過幾個專案後發現有些問題：</p>
<p>首先是必須要把客戶整個站的 wp-content 都 clone 下來，遇到比較大型的站這對我 128GB 的 MBP 負擔很大…</p>
<p>其次在設定 .gitignore 時要處理比較多的部分，有時候也會不小心把需要 ignore 的東西給 commit 進去。另外如果要提供給客戶下載正在開發中的外掛時，直接 download 就會抓回一大包，客戶還要從一大包之中去找到正確的外掛。</p>
<p>所以我現在都是一支外掛做一個版控，好處是本機開發環境只要安裝可能需要的外掛即可，不用把整包 wp-content 跟資料庫載到自己的電腦，然後 gitignore 也比較好設定，主要我會把測試相關以及 vendor 資料夾忽略掉，</p>
<p>測試主要會在本機以及測試機執行，所以不宜把所有的套件都上傳到正式機，這部分需要透過自動化部署工具來決定哪些套件該裝哪些不用裝，這部分會在自動部署一文中提及。</p>
<p>另外的好處是在 Github 頁面上可以設定 Releases 功能來讓客戶下載指定版本，也能看到每個版本更新的項目。</p>
<p>但如果一個專案裡面需要開發多支外掛，或是有改過一些既有的外掛需要納入版控時，數量一多就會不好管理，於是我採用 Github 的 Organization 來進行分類。把同一個專案不同外掛的存放庫都集中管理。</p>
<p>在本機的部分就使用 VSCode 的工作區功能，把需要處理到的外掛都加進到同一個工作區，然後在 commit 的時候透過內建的 Git 工具各自處理。</p>
<h3 id="5-WordPress-Coding-Standard"><a href="#5-WordPress-Coding-Standard" class="headerlink" title="5.WordPress Coding Standard"></a>5.WordPress Coding Standard</h3><p>到這邊就已經完成了開發環境的基本設定，但在真正開始 coding 之前，有件事雖然不是強制但我還是逼著自己習慣，那就是 WordPress 程式碼規範。</p>
<p>PHP 有一套自己的程式碼規範，叫做 PHP Standards Recommendations ( PSR )，雖然 WordPress 是用 PHP 寫的，但在規範上有許多地方不一樣，雖然自己本身從來沒在照什麼規範寫程式，但自從知道有這東西後就還是覺得要嘗試看看，來建立自己寫程式的習慣。</p>
<p>因為我都是在寫 WordPress，所以就理所當然的照著 WP 的規範走，一開始很不習慣，到現在老實說也還是很不自在，常常光是要整理格式就打斷了程式邏輯的思考，所以整理規範這件事我都是放在重構的時候來做，第一次在寫的時候就不管它了XD</p>
<p>後來透過 Terry Lin 大大的推薦知道 VSCode 有個好工具叫做 <a target="_blank" rel="noopener" href="https://marketplace.visualstudio.com/items?itemName=wongjn.php-sniffer">PHP Sniffer</a>，可以選擇要遵循的規範並且在編輯器中即時顯示不符合規範之處，另外還可以搭配快速鍵進行修正，可以搞定我最討厭的變數對齊：</p>
<p><img src="https://oberonlai.blog/wp-content/uploads/wordpress-plugin-boilerplate/wordpress-plugin-boilerplate-03.jpg"></p>
<p><img src="https://oberonlai.blog/wp-content/uploads/wordpress-plugin-boilerplate/wordpress-plugin-boilerplate-04.jpg"></p>
<p>自動修正可以修到七八成，剩下的只要補上 PHPDoc 的說明即可。</p>
<p><img src="https://oberonlai.blog/wp-content/uploads/wordpress-plugin-boilerplate/wordpress-plugin-boilerplate-01.jpg"></p>
<p>安裝 PHP Sniffer 記得要在它的設定裡面將 PHPCS Standard 改成 WordPress，這樣就會以 WordPress 的程式碼規範來檢查，更多這部分的說明可以參考<a target="_blank" rel="noopener" href="https://ithelp.ithome.com.tw/articles/10244668?sc=hot">使用 PHP CodeSniffer 幫助熟悉 WordPress 程式碼風格</a>。</p>
<p>安裝與設定完成後，就會看到有不符合規範的地方會在下面出現紅色波浪線，滑鼠停留在上面一下下就會出現規範說明，然後根據說明進行修改即可。</p>
<p><img src="https://oberonlai.blog/wp-content/uploads/wordpress-plugin-boilerplate/wordpress-plugin-boilerplate-02.jpg"></p>
<p>這邊補充一下，有時候會遇到無法符合規範的狀況，像是要使用其他外掛的變數名稱，而這外掛並沒有依照規範來寫，另外一種狀況是 WordPress 規範中類別的檔名要用 class-xxx.php，有 template tag 的要用 xxx-template.php 這樣，</p>
<p>但在研究 PHPUnit 單元測試的時候發現這樣無法運作，原因是 PHPUnit 測試檔要載入被測試的類別時，必須要用 PSR-4 的機制來載入，然後 PSR-4 規定類別叫什麼檔名就要叫什麼，</p>
<p>如果類別叫做 User，則檔名就一定要叫做 User.php，寫 class-User.php 會無法載入，我測試過用 require 或 include 也無法正確載入，最後只能忽略某些 WordPress 程式碼規範。</p>
<p>忽略的常用方法有兩種，分為忽略當行或多行，單行的話直接在該行後面加入註解，並把規則名稱寫在註解中即可</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token variable">$AbCd</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'bbb'</span><span class="token punctuation">;</span> <span class="token comment">//phpcs:ignore WordPress.NamingConventions.ValidVariableName.VariableNotSnakeCase</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>WordPress 程式碼規範規定變數名稱必須要用底線而非駝峰式寫法，這時候直接在後面接上 //phpcs:ignore 加規則名稱，規則名稱可以在 PHP Sniffer 跳出的提示視窗中進行複製</p>
<p><img src="https://oberonlai.blog/wp-content/uploads/wordpress-plugin-boilerplate/wordpress-plugin-boilerplate-05.jpg"></p>
<p>如果一次要忽略多行就更簡單了，只要用兩個註解把要忽略的部分包住即可：</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token comment">// @codingStandardsIgnoreStart</span>
<span class="token variable">$AbCd</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'bbb'</span><span class="token punctuation">;</span>
<span class="token variable">$ACaaa</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'abcdefg'</span><span class="token punctuation">;</span>
<span class="token comment">// @codingStandardsIgnoreEnd</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="小結"><a href="#小結" class="headerlink" title="小結"></a>小結</h2><p>在開發 WordPress 外掛時整合 Composer 可以很方便的安裝一些實用的套件以及自由組織資料夾內容，這樣在程式重構上能達到最大的彈性，另一方面，透過 Coding Standard 養成程式撰寫的習慣可以幫未來的自己或是團隊成員理解程式碼，接下來我們繼續挖掘 Composer 有什麼好物可以用吧～</p>

    </div>

    
    
    

      <footer class="post-footer">
          
          <div class="post-tags">
              <a href="/tw/tags/boilerplate/" rel="tag"><i class="fa fa-tag"></i> boilerplate</a>
              <a href="/tw/tags/composer/" rel="tag"><i class="fa fa-tag"></i> composer</a>
              <a href="/tw/tags/phpcs/" rel="tag"><i class="fa fa-tag"></i> phpcs</a>
              <a href="/tw/tags/git/" rel="tag"><i class="fa fa-tag"></i> git</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/tw/wordpress-taiwan-stock/" rel="prev" title="WordPress 台股指數外掛">
      <i class="fa fa-chevron-left"></i> WordPress 台股指數外掛
    </a></div>
      <div class="post-nav-item">
    <a href="/tw/wordpress-and-composer/" rel="next" title="【 心得 】WordPress 外掛開發日記 (二) - 套件">
      【 心得 】WordPress 外掛開發日記 (二) - 套件 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          
    
  <div class="comments">
    <div id="disqus_thread">
      <noscript>Please enable JavaScript to view the comments powered by Disqus.</noscript>
    </div>
  </div>
  

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目錄
        </li>
        <li class="sidebar-nav-overview">
          本站概要
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="賴俊吾 / Oberon Lai"
      src="/tw/images/avatar.jpg">
  <p class="site-author-name" itemprop="name">賴俊吾 / Oberon Lai</p>
  <div class="site-description" itemprop="description">現為全職 WordPress 工程師，網站開發經歷 11 年，專攻前端工程與 WordPress 佈景主題、外掛客製化開發</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/tw/archives">
          <span class="site-state-item-count">258</span>
          <span class="site-state-item-name">文章</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/tw/categories/">
        <span class="site-state-item-count">38</span>
        <span class="site-state-item-name">分類</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tw/tags/">
        <span class="site-state-item-count">80</span>
        <span class="site-state-item-name">標籤</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/oberonlai" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;oberonlai" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:m615926@gmail.com" title="E-Mail → mailto:m615926@gmail.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://twitter.com/oberonlai" title="Twitter → https:&#x2F;&#x2F;twitter.com&#x2F;oberonlai" rel="noopener" target="_blank"><i class="fab fa-twitter fa-fw"></i>Twitter</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://www.facebook.com/m615926" title="FB Page → https:&#x2F;&#x2F;www.facebook.com&#x2F;m615926" rel="noopener" target="_blank"><i class="fab fa-facebook fa-fw"></i>FB Page</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">賴俊吾 / Oberon Lai</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
    <span title="總字數">599k</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="所需總閱讀時間">9:05</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://mist.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Mist</a> 強力驅動
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/tw/lib/anime.min.js"></script>
  <script src="/tw/lib/pjax/pjax.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/medium-zoom@1/dist/medium-zoom.min.js"></script>

<script src="/tw/js/utils.js"></script>


<script src="/tw/js/schemes/muse.js"></script>


<script src="/tw/js/next-boot.js"></script>

  <script>
var pjax = new Pjax({
  selectors: [
    'head title',
    '#page-configurations',
    '.content-wrap',
    '.post-toc-wrap',
    '.languages',
    '#pjax'
  ],
  switches: {
    '.post-toc-wrap': Pjax.switches.innerHTML
  },
  analytics: false,
  cacheBust: false,
  scrollTo : !CONFIG.bookmark.enable
});

window.addEventListener('pjax:success', () => {
  document.querySelectorAll('script[data-pjax], script#page-configurations, #pjax script').forEach(element => {
    var code = element.text || element.textContent || element.innerHTML || '';
    var parent = element.parentNode;
    parent.removeChild(element);
    var script = document.createElement('script');
    if (element.id) {
      script.id = element.id;
    }
    if (element.className) {
      script.className = element.className;
    }
    if (element.type) {
      script.type = element.type;
    }
    if (element.src) {
      script.src = element.src;
      // Force synchronous loading of peripheral JS.
      script.async = false;
    }
    if (element.dataset.pjax !== undefined) {
      script.dataset.pjax = '';
    }
    if (code !== '') {
      script.appendChild(document.createTextNode(code));
    }
    parent.appendChild(script);
  });
  NexT.boot.refresh();
  // Define Motion Sequence & Bootstrap Motion.
  if (CONFIG.motion.enable) {
    NexT.motion.integrator
      .init()
      .add(NexT.motion.middleWares.subMenu)
      .add(NexT.motion.middleWares.postList)
      .bootstrap();
  }
  NexT.utils.updateSidebarPosition();
});
</script>




  




  
<script src="/tw/js/local-search.js"></script>













    <div id="pjax">
  

  

<script>
  function loadCount() {
    var d = document, s = d.createElement('script');
    s.src = 'https://oberon-lai.disqus.com/count.js';
    s.id = 'dsq-count-scr';
    (d.head || d.body).appendChild(s);
  }
  // defer loading until the whole page loading is completed
  window.addEventListener('load', loadCount, false);
</script>
<script>
  var disqus_config = function() {
    this.page.url = "https://oberonlai.blog/tw/wordpress-plugin-boilerplate/";
    this.page.identifier = "wordpress-plugin-boilerplate/";
    this.page.title = "【 心得 】WordPress 外掛開發日記 (一) - 架構";
    };
  NexT.utils.loadComments(document.querySelector('#disqus_thread'), () => {
    if (window.DISQUS) {
      DISQUS.reset({
        reload: true,
        config: disqus_config
      });
    } else {
      var d = document, s = d.createElement('script');
      s.src = 'https://oberon-lai.disqus.com/embed.js';
      s.setAttribute('data-timestamp', '' + +new Date());
      (d.head || d.body).appendChild(s);
    }
  });
</script>

    </div>
</body>
</html>
